{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\asus\\\\ecommerce project\\\\ecommerce\\\\ecommerce-app\\\\src\\\\components\\\\StripeCheckout.js\",\n    _s = $RefreshSig$();\n\nimport React, { useEffect, useState } from 'react';\nimport { CardElement, useStripe, useElements } from '@stripe/react-stripe-js';\nimport { useDispatch, useSelector } from 'react-redux';\nimport { createPaymentIntent } from '../functions/stripe';\nimport { Link } from 'react-router-dom';\nimport { createOrder, emptyCart } from '../functions/user';\nimport { Card } from 'antd';\nimport { DollarOutlined, CheckOutlined } from '@ant-design/icons';\nimport Laptop from '../images/laptop.png';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\n\nconst StripeCheckout = () => {\n  _s();\n\n  const dispatch = useDispatch();\n  const {\n    user\n  } = useSelector(state => ({ ...state\n  }));\n  const [succeeded, setSucceeded] = useState(false);\n  const [error, setError] = useState(null);\n  const [processing, setProcessing] = useState(false);\n  const [disabled, setDisabled] = useState(true);\n  const [clientSecret, setClientSecret] = useState(\"\");\n  const [cartTotal, setCartTotal] = useState(0);\n  const [payable, setPayable] = useState(0);\n  const stripe = useStripe();\n  const elements = useElements();\n  useEffect(() => {\n    createPaymentIntent(user.token).then(res => {\n      console.log('hey');\n      console.log('create payment intent', res);\n      setClientSecret(res.data.clientSecret);\n      setCartTotal(res.data.cartTotal);\n      setPayable(res.data.cartTotal);\n    });\n  }, []);\n\n  const handleSubmit = async e => {\n    e.preventDefault();\n    setProcessing(true);\n    const payload = await stripe.confirmCardPayment(clientSecret, {\n      payment_method: {\n        card: elements.getElement(CardElement),\n        billing_details: {\n          name: e.target.name.value\n        }\n      }\n    });\n\n    if (payload.error) {\n      setError(`Payment failed ${payload.error.message}`);\n      setProcessing(false);\n    } else {\n      createOrder(payload, user.token).then(res => {\n        if (res.data.ok) {\n          if (typeof window !== 'undefined') localStorage.removeItem('cart');\n          dispatch({\n            type: 'ADD_TO_CART',\n            payload: []\n          });\n          emptyCart(user.token);\n        }\n      });\n      console.log(JSON.stringify(payload, null, 4));\n      setError(null);\n      setProcessing(false);\n      setSucceeded(true);\n    } //\n\n  };\n\n  const handleChange = async e => {\n    setDisabled(e.empty);\n    setError(e.error ? e.error.message : \"\"); //\n  };\n\n  const cartStyle = {\n    style: {\n      base: {\n        color: \"#32325d\",\n        fontFamily: \"Arial, sans-serif\",\n        fontSmoothing: \"antialiased\",\n        fontSize: \"16px\",\n        \"::placeholder\": {\n          color: \"#32325d\"\n        }\n      },\n      invalid: {\n        color: \"#fa755a\",\n        iconColor: \"#fa755a\"\n      }\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(_Fragment, {\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"text-center pb-5\",\n      children: /*#__PURE__*/_jsxDEV(Card, {\n        cover: /*#__PURE__*/_jsxDEV(\"img\", {\n          src: Laptop,\n          style: {\n            height: '200px',\n            objectFit: 'contain',\n            marginBottom: '-50px'\n          }\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 109,\n          columnNumber: 13\n        }, this),\n        actions: [/*#__PURE__*/_jsxDEV(_Fragment, {\n          children: [/*#__PURE__*/_jsxDEV(DollarOutlined, {\n            className: \"text-info\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 120,\n            columnNumber: 15\n          }, this), \" \", /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 120,\n            columnNumber: 57\n          }, this), \"Cart Total: Rs.\", cartTotal]\n        }, void 0, true), /*#__PURE__*/_jsxDEV(_Fragment, {\n          children: [/*#__PURE__*/_jsxDEV(CheckOutlined, {\n            className: \"text-info\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 123,\n            columnNumber: 15\n          }, this), \" \", /*#__PURE__*/_jsxDEV(\"br\", {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 123,\n            columnNumber: 54\n          }, this), \" Total Payable : Rs.\", payable]\n        }, void 0, true)]\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 107,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 106,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n      id: \"payment-form\",\n      className: \"stripe-form\",\n      onSubmit: handleSubmit,\n      children: [/*#__PURE__*/_jsxDEV(CardElement, {\n        id: \"card-element\",\n        options: cartStyle,\n        onChange: handleChange\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 132,\n        columnNumber: 14\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        className: \"stripe-button\",\n        disabled: processing || succeeded || disabled,\n        children: /*#__PURE__*/_jsxDEV(\"span\", {\n          id: \"button-text\",\n          children: processing ? /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"spinner\",\n            id: \"spinner\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 140,\n            columnNumber: 31\n          }, this) : \"Pay\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 139,\n          columnNumber: 15\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 137,\n        columnNumber: 11\n      }, this), error && /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"card-error\",\n        role: \"alert\",\n        children: error\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 144,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 131,\n      columnNumber: 10\n    }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n      className: succeeded ? \"result-message\" : \"result-message hidden\",\n      children: [\"Payment Successful.\", \" \", /*#__PURE__*/_jsxDEV(Link, {\n        to: \"/user/history\",\n        children: \" See it on your purchase history\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 152,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 150,\n      columnNumber: 10\n    }, this)]\n  }, void 0, true);\n};\n\n_s(StripeCheckout, \"wHC52UCZQkRkPQB+ceo/ZSb338o=\", false, function () {\n  return [useDispatch, useSelector, useStripe, useElements];\n});\n\n_c = StripeCheckout;\nexport default StripeCheckout;\n\nvar _c;\n\n$RefreshReg$(_c, \"StripeCheckout\");","map":{"version":3,"sources":["C:/Users/asus/ecommerce project/ecommerce/ecommerce-app/src/components/StripeCheckout.js"],"names":["React","useEffect","useState","CardElement","useStripe","useElements","useDispatch","useSelector","createPaymentIntent","Link","createOrder","emptyCart","Card","DollarOutlined","CheckOutlined","Laptop","StripeCheckout","dispatch","user","state","succeeded","setSucceeded","error","setError","processing","setProcessing","disabled","setDisabled","clientSecret","setClientSecret","cartTotal","setCartTotal","payable","setPayable","stripe","elements","token","then","res","console","log","data","handleSubmit","e","preventDefault","payload","confirmCardPayment","payment_method","card","getElement","billing_details","name","target","value","message","ok","window","localStorage","removeItem","type","JSON","stringify","handleChange","empty","cartStyle","style","base","color","fontFamily","fontSmoothing","fontSize","invalid","iconColor","height","objectFit","marginBottom"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from 'react'\r\nimport { CardElement,useStripe,useElements } from '@stripe/react-stripe-js'\r\nimport { useDispatch,useSelector } from 'react-redux'\r\nimport { createPaymentIntent } from '../functions/stripe'\r\nimport { Link } from 'react-router-dom'\r\nimport { createOrder, emptyCart } from '../functions/user'\r\nimport {Card} from 'antd'\r\nimport {DollarOutlined,CheckOutlined} from '@ant-design/icons'\r\nimport Laptop from '../images/laptop.png'\r\n\r\nconst StripeCheckout = () => {\r\n const dispatch=useDispatch();\r\n const {user}=useSelector((state)=>({...state}))\r\n\r\n const[succeeded,setSucceeded]=useState(false)\r\n const[error,setError]=useState(null)\r\n const[processing,setProcessing]=useState(false)\r\n const[disabled,setDisabled]=useState(true)\r\n const[clientSecret,setClientSecret]=useState(\"\")\r\nconst [cartTotal,setCartTotal]=useState(0);\r\nconst [payable,setPayable]=useState(0)\r\n\r\n    const stripe=useStripe();\r\n    const elements=useElements();\r\n\r\n    useEffect(()=>{\r\n        createPaymentIntent(user.token)\r\n        .then(res=>{\r\n            console.log('hey')\r\n            console.log('create payment intent',res)\r\n            setClientSecret(res.data.clientSecret)\r\n            setCartTotal(res.data.cartTotal)\r\n            setPayable(res.data.cartTotal)\r\n        })\r\n    },[])\r\n\r\n    const handleSubmit=async(e)=>{\r\n      e.preventDefault()\r\n      setProcessing(true)\r\n      const payload=await stripe.confirmCardPayment(clientSecret,{\r\n        payment_method:{\r\n          card:elements.getElement(CardElement),\r\n          billing_details:{\r\n            name: e.target.name.value\r\n          },\r\n        },\r\n\r\n      })\r\n\r\n      if(payload.error){\r\n        setError(`Payment failed ${payload.error.message}`)\r\n        setProcessing(false)\r\n      }\r\n      else{\r\n\r\n         createOrder(payload,user.token)\r\n        .then((res)=>{\r\n          if(res.data.ok){\r\n            if(typeof window!=='undefined' ) localStorage.removeItem('cart');\r\n\r\n            dispatch({\r\n              type:'ADD_TO_CART',\r\n              payload:[]\r\n            });\r\n\r\n            emptyCart(user.token);\r\n          }\r\n        })\r\n         \r\n\r\n\r\n        console.log(JSON.stringify(payload,null,4));\r\n        setError(null);\r\n        setProcessing(false)\r\n        setSucceeded(true)\r\n      }\r\n        //\r\n    }\r\n    const handleChange=async(e)=>{\r\n\r\n      setDisabled(e.empty)\r\n      setError(e.error?e.error.message:\"\")\r\n        //\r\n    }\r\n    const cartStyle = {\r\n        style: {\r\n          base: {\r\n            color: \"#32325d\",\r\n            fontFamily: \"Arial, sans-serif\",\r\n            fontSmoothing: \"antialiased\",\r\n            fontSize: \"16px\",\r\n            \"::placeholder\": {\r\n              color: \"#32325d\",\r\n            },\r\n          },\r\n          invalid: {\r\n            color: \"#fa755a\",\r\n            iconColor: \"#fa755a\",\r\n          },\r\n        },\r\n      };\r\n\r\n    return (\r\n        <>\r\n       \r\n        <div className='text-center pb-5'>\r\n        <Card\r\n          cover={\r\n            <img\r\n             src={Laptop}\r\n             style={{\r\n              height:'200px',\r\n              objectFit:'contain',\r\n              marginBottom:'-50px',\r\n             }}\r\n            />\r\n          }\r\n          actions={[\r\n            <>\r\n              <DollarOutlined className='text-info'  /> <br/>Cart Total: Rs.{cartTotal}\r\n            </>,\r\n            <>\r\n              <CheckOutlined className='text-info'/> <br/> Total Payable : Rs.{payable}\r\n            </>\r\n          ]}\r\n        />\r\n\r\n        </div>\r\n\r\n       \r\n         <form id='payment-form' className='stripe-form' onSubmit={handleSubmit}>\r\n             <CardElement \r\n             id='card-element'\r\n             options={cartStyle}\r\n             onChange={handleChange}\r\n             />\r\n          <button className='stripe-button' disabled={processing || succeeded || disabled}>\r\n\r\n              <span id='button-text'>\r\n                  {processing?<div className='spinner' id='spinner'></div>:\"Pay\"}\r\n              </span>\r\n          </button>\r\n        {error && (\r\n          <div className='card-error' role='alert'>\r\n            {error}\r\n          </div>\r\n        )}\r\n\r\n         </form>\r\n         <p className={succeeded?\"result-message\": \"result-message hidden\"}>\r\n          Payment Successful.{\" \"}\r\n          <Link to='/user/history'> See it on your purchase history</Link>\r\n          </p>\r\n        </>\r\n    )\r\n\r\n}\r\n\r\nexport default StripeCheckout"]},"metadata":{},"sourceType":"module"}