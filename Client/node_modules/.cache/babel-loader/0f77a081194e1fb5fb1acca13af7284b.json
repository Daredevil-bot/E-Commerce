{"ast":null,"code":"import _asyncToGenerator from\"C:\\\\Users\\\\asus\\\\ecommerce project\\\\ecommerce\\\\ecommerce-app\\\\server\\\\Client\\\\node_modules\\\\@babel\\\\runtime\\\\helpers\\\\esm\\\\asyncToGenerator.js\";import _objectSpread from\"C:\\\\Users\\\\asus\\\\ecommerce project\\\\ecommerce\\\\ecommerce-app\\\\server\\\\Client\\\\node_modules\\\\@babel\\\\runtime\\\\helpers\\\\esm\\\\objectSpread2.js\";import _slicedToArray from\"C:\\\\Users\\\\asus\\\\ecommerce project\\\\ecommerce\\\\ecommerce-app\\\\server\\\\Client\\\\node_modules\\\\@babel\\\\runtime\\\\helpers\\\\esm\\\\slicedToArray.js\";import _regeneratorRuntime from\"C:\\\\Users\\\\asus\\\\ecommerce project\\\\ecommerce\\\\ecommerce-app\\\\server\\\\Client\\\\node_modules\\\\@babel\\\\runtime\\\\regenerator\\\\index.js\";import React from'react';import{useState,useEffect}from'react';import{useSelector}from'react-redux';import{getCategories}from'../../../functions/category';import{createSub,deleteSub,getSubs}from'../../../functions/sub';import{toast}from'react-toastify';import{DeleteOutlined,EditOutlined}from'@ant-design/icons';import AdminNav from'../../../components/nav/AdminNav';import{Link}from'react-router-dom';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var CreateSub=function CreateSub(){var _useState=useState(''),_useState2=_slicedToArray(_useState,2),name=_useState2[0],setname=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),categories=_useState4[0],setcategories=_useState4[1];var _useState5=useState(''),_useState6=_slicedToArray(_useState5,2),keyword=_useState6[0],setkeyword=_useState6[1];var _useState7=useState(''),_useState8=_slicedToArray(_useState7,2),category=_useState8[0],setcategory=_useState8[1];//this will send the object id of parent category needed for the sub category\nvar _useState9=useState([]),_useState10=_slicedToArray(_useState9,2),subs=_useState10[0],setsubs=_useState10[1];var _useSelector=useSelector(function(state){return _objectSpread({},state);}),user=_useSelector.user;useEffect(function(){listCategory();listsubs();},[]);var listCategory=function listCategory(){return getCategories().then(function(res){return setcategories(res.data);}).catch(function(err){return console.log(err);});};var listsubs=function listsubs(){return getSubs().then(function(res){return setsubs(res.data);}).catch(function(err){return console.log(err);});};var handleClick=function handleClick(e){e.preventDefault();console.log(\"clicked\");createSub({name:name,parent:category},user.token).then(function(e){toast.success('Sub created');listsubs();}).catch(function(err){if(err.response.status===400)toast.error(err.response.data);console.log(err);});};var handleDelete=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(slug){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:if(window.confirm('Delete?')){deleteSub(slug,user.token).then(function(e){toast.error(\"\".concat(e.data.name,\" Deleted succesfully refresh page to see changes\"));listsubs();}).catch(function(err){if(err.response.status===400){toast.error(err.response.data);}});}case 1:case\"end\":return _context.stop();}}},_callee);}));return function handleDelete(_x){return _ref.apply(this,arguments);};}();var handleSearch=function handleSearch(e){e.preventDefault();setkeyword(e.target.value.toLowerCase());};var searched=function searched(keyword){return function(c){return c.name.toLowerCase().includes(keyword);};};return/*#__PURE__*/_jsx(\"div\",{className:\"container-fluid\",children:/*#__PURE__*/_jsxs(\"div\",{className:\"row\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"col\",children:/*#__PURE__*/_jsx(AdminNav,{})}),/*#__PURE__*/_jsxs(\"div\",{className:\"col-10\",style:{margin:'0px 0px 0px 00px'},children:[/*#__PURE__*/_jsx(\"div\",{className:\"col\",children:/*#__PURE__*/_jsx(\"h2\",{children:\"Create Category\"})}),/*#__PURE__*/_jsxs(\"form\",{onSubmit:handleClick,children:[/*#__PURE__*/_jsx(\"input\",{type:\"text\",className:\"form-control\",onChange:function onChange(e){return setname(e.target.value);},value:name,autoFocus:true,required:true,placeholder:\"Enter name of category\",style:{margin:'0px 0px 0px 0px',width:'1000px'}}),/*#__PURE__*/_jsx(\"div\",{className:\"col\",children:/*#__PURE__*/_jsx(\"h3\",{children:\"Parent Category\"})}),/*#__PURE__*/_jsxs(\"select\",{className:\"form-control\",style:{width:'1000px'},placeholder:\"Select name of parent category\",onChange:function onChange(e){return setcategory(e.target.value);},children:[/*#__PURE__*/_jsx(\"option\",{children:\"Please select\"}),categories.length>0&&categories.map(function(c){return/*#__PURE__*/_jsx(\"option\",{value:c._id,children:c.name},c._id);})]}),/*#__PURE__*/_jsx(\"button\",{type:\"submit\",value:\"submit\",className:\"btn btn-primary\",style:{margin:'20px 0px 0px 0px'},children:\"Save\"}),/*#__PURE__*/_jsx(\"input\",{type:\"text\",value:keyword,className:\"form-control\",onChange:handleSearch,style:{margin:'20px 0px 0px 0px',width:'1000px'}})]}),/*#__PURE__*/_jsx(\"div\",{children:subs.filter(searched(keyword)).map(function(s){return/*#__PURE__*/_jsxs(\"div\",{className:\"alert alert-secondary\",style:{margin:'10px 0px 0px 0px',width:'1000px'},children:[s.name,/*#__PURE__*/_jsx(\"span\",{onClick:function onClick(){return handleDelete(s.slug);},className:\"btn btn-sm  float-end text-warning\",children:/*#__PURE__*/_jsx(DeleteOutlined,{})}),/*#__PURE__*/_jsx(\"span\",{className:\"btn btn-sm  float-end \",children:/*#__PURE__*/_jsx(Link,{to:\"/admin/sub/\".concat(s.slug),children:/*#__PURE__*/_jsx(EditOutlined,{})})})]},s._id);})})]})]})});};export default CreateSub;","map":{"version":3,"sources":["C:/Users/asus/ecommerce project/ecommerce/ecommerce-app/server/Client/src/pages/admin/sub/CreateSub.js"],"names":["React","useState","useEffect","useSelector","getCategories","createSub","deleteSub","getSubs","toast","DeleteOutlined","EditOutlined","AdminNav","Link","CreateSub","name","setname","categories","setcategories","keyword","setkeyword","category","setcategory","subs","setsubs","state","user","listCategory","listsubs","then","res","data","catch","err","console","log","handleClick","e","preventDefault","parent","token","success","response","status","error","handleDelete","slug","window","confirm","handleSearch","target","value","toLowerCase","searched","c","includes","margin","width","length","map","_id","filter","s"],"mappings":"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","sourcesContent":["import React from 'react'\r\nimport { useState,useEffect } from 'react'\r\nimport { useSelector } from 'react-redux'\r\nimport { getCategories } from '../../../functions/category'\r\nimport { createSub,deleteSub,getSubs } from '../../../functions/sub'\r\nimport { toast } from 'react-toastify'\r\nimport { DeleteOutlined ,EditOutlined } from '@ant-design/icons';\r\n\r\nimport AdminNav from '../../../components/nav/AdminNav'\r\nimport { Link } from 'react-router-dom'\r\n\r\nconst CreateSub = () => {\r\n    const[name,setname]=useState('')\r\n    const[categories,setcategories]=useState([]);\r\n    const[keyword,setkeyword]=useState('');\r\n    const[category,setcategory]=useState('')       //this will send the object id of parent category needed for the sub category\r\n    const [subs,setsubs]=useState([])\r\n    const {user}=useSelector(state=>({...state}))\r\n    useEffect(()=>{\r\n        listCategory()\r\n        listsubs()\r\n    },[])\r\n\r\n     const listCategory=()=>getCategories()\r\n     .then((res)=>setcategories(res.data))\r\n     .catch(err=>console.log(err))\r\n     const listsubs=()=>getSubs()\r\n     .then((res)=>setsubs(res.data))\r\n     .catch(err=>console.log(err))\r\n     \r\n    const handleClick=(e)=>{\r\n        e.preventDefault()\r\n        console.log(\"clicked\")\r\n        createSub({name,parent:category},user.token)\r\n        .then((e)=>{\r\n            \r\n            toast.success('Sub created')\r\n            listsubs()\r\n        })\r\n        .catch(err=>{\r\n            if(err.response.status===400) toast.error(err.response.data)\r\n            console.log(err)\r\n        })\r\n            \r\n    \r\n\r\n    }\r\n    const handleDelete= async (slug)=>{\r\n        if(window.confirm('Delete?')){\r\n            deleteSub(slug,user.token)\r\n            .then((e)=>{\r\n                toast.error(`${e.data.name} Deleted succesfully refresh page to see changes`)\r\n                listsubs()\r\n            })\r\n            .catch(err=>{\r\n                if(err.response.status===400){\r\n                    toast.error(err.response.data)\r\n                }\r\n            })\r\n        }\r\n    }\r\n    const handleSearch=(e)=>{\r\n        e.preventDefault()\r\n        setkeyword(e.target.value.toLowerCase())\r\n    }\r\n     const searched=(keyword)=>(c)=> c.name.toLowerCase().includes(keyword)\r\n\r\n     \r\n     \r\n    \r\n        return (\r\n        <div className='container-fluid' >\r\n            <div className='row'>\r\n            <div className='col'>\r\n                    <AdminNav/>\r\n                </div>\r\n                <div className='col-10'  style={\r\n                    {margin: '0px 0px 0px 00px'}\r\n                }>\r\n                   \r\n                   <div className='col' ><h2>Create Category</h2></div>\r\n\r\n               \r\n                  <form onSubmit={handleClick}>\r\n                      <input type=\"text\" \r\n                      className='form-control'\r\n                      onChange={(e)=>setname(e.target.value)}\r\n                      value={name}\r\n                      autoFocus\r\n                      required\r\n                      \r\n                      placeholder='Enter name of category'\r\n                      style={{margin:'0px 0px 0px 0px',width:'1000px'}}>\r\n                        \r\n                        \r\n                      </input>\r\n                      <div className='col' ><h3>Parent Category</h3></div>\r\n                      <select className='form-control' style={{width:'1000px'}} placeholder='Select name of parent category' onChange={(e)=>setcategory(e.target.value)}>\r\n                          <option>Please select</option>\r\n                          {categories.length >0 && categories.map((c)=>(\r\n                              <option key={c._id} value={c._id} >\r\n                                  {c.name}\r\n                              </option>\r\n                          ))}\r\n\r\n                         </select>\r\n                         \r\n                      \r\n                      \r\n               \r\n                <button type='submit' value=\"submit\"className='btn btn-primary' style={{margin:'20px 0px 0px 0px'}}>Save</button>\r\n                <input type='text' value={keyword} className='form-control' onChange={handleSearch} style={{margin:'20px 0px 0px 0px',width:'1000px'}}></input>\r\n                  </form>\r\n                  {<div >{subs.filter(searched(keyword)).map((s)=>(\r\n                <div className='alert alert-secondary' style={{margin:'10px 0px 0px 0px',width:'1000px'}} key={s._id} >\r\n                    {s.name}\r\n                    <span onClick={()=>handleDelete(s.slug)} className='btn btn-sm  float-end text-warning' >\r\n                       <DeleteOutlined/>\r\n                    </span>\r\n                    <span className='btn btn-sm  float-end ' >\r\n                       <Link to={`/admin/sub/${s.slug}`}><EditOutlined/></Link>\r\n                    </span>\r\n\r\n                </div>\r\n\r\n            )\r\n\r\n            )}\r\n            </div> }\r\n                 \r\n                </div>\r\n                \r\n                \r\n                \r\n            </div>\r\n            \r\n        </div>\r\n        \r\n    )\r\n}\r\n\r\nexport default CreateSub"]},"metadata":{},"sourceType":"module"}