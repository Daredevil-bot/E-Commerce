{"ast":null,"code":"import _toArray from\"C:\\\\Users\\\\asus\\\\ecommerce project\\\\ecommerce\\\\ecommerce-app\\\\server\\\\Client\\\\node_modules\\\\@babel\\\\runtime\\\\helpers\\\\esm\\\\toArray.js\";import _classCallCheck from\"C:\\\\Users\\\\asus\\\\ecommerce project\\\\ecommerce\\\\ecommerce-app\\\\server\\\\Client\\\\node_modules\\\\@babel\\\\runtime\\\\helpers\\\\esm\\\\classCallCheck.js\";import _createClass from\"C:\\\\Users\\\\asus\\\\ecommerce project\\\\ecommerce\\\\ecommerce-app\\\\server\\\\Client\\\\node_modules\\\\@babel\\\\runtime\\\\helpers\\\\esm\\\\createClass.js\";import _get from\"C:\\\\Users\\\\asus\\\\ecommerce project\\\\ecommerce\\\\ecommerce-app\\\\server\\\\Client\\\\node_modules\\\\@babel\\\\runtime\\\\helpers\\\\esm\\\\get.js\";import _getPrototypeOf from\"C:\\\\Users\\\\asus\\\\ecommerce project\\\\ecommerce\\\\ecommerce-app\\\\server\\\\Client\\\\node_modules\\\\@babel\\\\runtime\\\\helpers\\\\esm\\\\getPrototypeOf.js\";import _inherits from\"C:\\\\Users\\\\asus\\\\ecommerce project\\\\ecommerce\\\\ecommerce-app\\\\server\\\\Client\\\\node_modules\\\\@babel\\\\runtime\\\\helpers\\\\esm\\\\inherits.js\";import _createSuper from\"C:\\\\Users\\\\asus\\\\ecommerce project\\\\ecommerce\\\\ecommerce-app\\\\server\\\\Client\\\\node_modules\\\\@babel\\\\runtime\\\\helpers\\\\esm\\\\createSuper.js\";import _asyncToGenerator from\"C:\\\\Users\\\\asus\\\\ecommerce project\\\\ecommerce\\\\ecommerce-app\\\\server\\\\Client\\\\node_modules\\\\@babel\\\\runtime\\\\helpers\\\\esm\\\\asyncToGenerator.js\";import _regeneratorRuntime from\"C:\\\\Users\\\\asus\\\\ecommerce project\\\\ecommerce\\\\ecommerce-app\\\\server\\\\Client\\\\node_modules\\\\@babel\\\\runtime\\\\regenerator\\\\index.js\";import{ao as _isIOS7Or8,ap as debugAssert,aq as _isIOS,ar as _isAndroid,as as _fail,at as _getRedirectUrl,au as _getProjectConfig,av as _createError,aw as _assert,ax as _getInstance,b as browserLocalPersistence,ay as _persistenceKeyName,az as AuthEventManager,a as browserSessionPersistence,aA as _getRedirectResult,aB as _clearRedirectOutcomes,aC as _castAuth}from'./index-839de510.js';export{A as ActionCodeOperation,ac as ActionCodeURL,G as AuthCredential,C as AuthErrorCodes,aE as AuthImpl,aH as AuthPopup,H as EmailAuthCredential,L as EmailAuthProvider,M as FacebookAuthProvider,F as FactorId,aI as FetchProvider,Q as GithubAuthProvider,N as GoogleAuthProvider,I as OAuthCredential,T as OAuthProvider,O as OperationType,J as PhoneAuthCredential,P as PhoneAuthProvider,m as PhoneMultiFactorGenerator,o as ProviderId,R as RecaptchaVerifier,aJ as SAMLAuthCredential,U as SAMLAuthProvider,S as SignInMethod,V as TwitterAuthProvider,aD as UserImpl,aw as _assert,aC as _castAuth,as as _fail,aG as _generateEventId,aF as _getClientVersion,ax as _getInstance,aA as _getRedirectResult,ay as _persistenceKeyName,a1 as applyActionCode,b as browserLocalPersistence,k as browserPopupRedirectResolver,a as browserSessionPersistence,a2 as checkActionCode,a0 as confirmPasswordReset,E as connectAuthEmulator,a4 as createUserWithEmailAndPassword,z as debugErrorMap,y as deleteUser,a9 as fetchSignInMethodsForEmail,ak as getAdditionalUserInfo,n as getAuth,ah as getIdToken,ai as getIdTokenResult,am as getMultiFactorResolver,j as getRedirectResult,K as inMemoryPersistence,i as indexedDBLocalPersistence,D as initializeAuth,a7 as isSignInWithEmailLink,Y as linkWithCredential,l as linkWithPhoneNumber,d as linkWithPopup,g as linkWithRedirect,an as multiFactor,t as onAuthStateChanged,q as onIdTokenChanged,ad as parseActionCodeURL,B as prodErrorMap,Z as reauthenticateWithCredential,r as reauthenticateWithPhoneNumber,e as reauthenticateWithPopup,h as reauthenticateWithRedirect,al as reload,aa as sendEmailVerification,$ as sendPasswordResetEmail,a6 as sendSignInLinkToEmail,p as setPersistence,W as signInAnonymously,X as signInWithCredential,_ as signInWithCustomToken,a5 as signInWithEmailAndPassword,a8 as signInWithEmailLink,s as signInWithPhoneNumber,c as signInWithPopup,f as signInWithRedirect,x as signOut,aj as unlink,w as updateCurrentUser,af as updateEmail,ag as updatePassword,u as updatePhoneNumber,ae as updateProfile,v as useDeviceLanguage,ab as verifyBeforeUpdateEmail,a3 as verifyPasswordResetCode}from'./index-839de510.js';import{querystringDecode}from'@firebase/util';import'@firebase/app';import'tslib';import'@firebase/logger';import'@firebase/component';/**\r\n * @license\r\n * Copyright 2021 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */function _cordovaWindow(){return window;}/**\r\n * @license\r\n * Copyright 2020 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */ /**\r\n * How long to wait after the app comes back into focus before concluding that\r\n * the user closed the sign in tab.\r\n */var REDIRECT_TIMEOUT_MS=2000;/**\r\n * Generates the URL for the OAuth handler.\r\n */function _generateHandlerUrl(_x,_x2,_x3){return _generateHandlerUrl2.apply(this,arguments);}/**\r\n * Validates that this app is valid for this project configuration\r\n */function _generateHandlerUrl2(){_generateHandlerUrl2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee7(auth,event,provider){var _a,_cordovaWindow4,BuildInfo,sessionDigest,additionalParams;return _regeneratorRuntime.wrap(function _callee7$(_context7){while(1){switch(_context7.prev=_context7.next){case 0:// Get the cordova plugins\n_cordovaWindow4=_cordovaWindow(),BuildInfo=_cordovaWindow4.BuildInfo;debugAssert(event.sessionId,'AuthEvent did not contain a session ID');_context7.next=4;return computeSha256(event.sessionId);case 4:sessionDigest=_context7.sent;additionalParams={};if(_isIOS()){// iOS app identifier\nadditionalParams['ibi']=BuildInfo.packageName;}else if(_isAndroid()){// Android app identifier\nadditionalParams['apn']=BuildInfo.packageName;}else{_fail(auth,\"operation-not-supported-in-this-environment\"/* OPERATION_NOT_SUPPORTED */);}// Add the display name if available\nif(BuildInfo.displayName){additionalParams['appDisplayName']=BuildInfo.displayName;}// Attached the hashed session ID\nadditionalParams['sessionId']=sessionDigest;return _context7.abrupt(\"return\",_getRedirectUrl(auth,provider,event.type,undefined,(_a=event.eventId)!==null&&_a!==void 0?_a:undefined,additionalParams));case 10:case\"end\":return _context7.stop();}}},_callee7);}));return _generateHandlerUrl2.apply(this,arguments);}function _validateOrigin(_x4){return _validateOrigin2.apply(this,arguments);}function _validateOrigin2(){_validateOrigin2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee8(auth){var _cordovaWindow5,BuildInfo,request;return _regeneratorRuntime.wrap(function _callee8$(_context8){while(1){switch(_context8.prev=_context8.next){case 0:_cordovaWindow5=_cordovaWindow(),BuildInfo=_cordovaWindow5.BuildInfo;request={};if(_isIOS()){request.iosBundleId=BuildInfo.packageName;}else if(_isAndroid()){request.androidPackageName=BuildInfo.packageName;}else{_fail(auth,\"operation-not-supported-in-this-environment\"/* OPERATION_NOT_SUPPORTED */);}// Will fail automatically if package name is not authorized\n_context8.next=5;return _getProjectConfig(auth,request);case 5:case\"end\":return _context8.stop();}}},_callee8);}));return _validateOrigin2.apply(this,arguments);}function _performRedirect(handlerUrl){// Get the cordova plugins\nvar _cordovaWindow2=_cordovaWindow(),cordova=_cordovaWindow2.cordova;return new Promise(function(resolve){cordova.plugins.browsertab.isAvailable(function(browserTabIsAvailable){var iabRef=null;if(browserTabIsAvailable){cordova.plugins.browsertab.openUrl(handlerUrl);}else{// TODO: Return the inappbrowser ref that's returned from the open call\niabRef=cordova.InAppBrowser.open(handlerUrl,_isIOS7Or8()?'_blank':'_system','location=yes');}resolve(iabRef);});});}/**\r\n * This function waits for app activity to be seen before resolving. It does\r\n * this by attaching listeners to various dom events. Once the app is determined\r\n * to be visible, this promise resolves. AFTER that resolution, the listeners\r\n * are detached and any browser tabs left open will be closed.\r\n */function _waitForAppResume(_x5,_x6,_x7){return _waitForAppResume2.apply(this,arguments);}/**\r\n * Checks the configuration of the Cordova environment. This has no side effect\r\n * if the configuration is correct; otherwise it throws an error with the\r\n * missing plugin.\r\n */function _waitForAppResume2(){_waitForAppResume2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee9(auth,eventListener,iabRef){var _cordovaWindow6,cordova,cleanup;return _regeneratorRuntime.wrap(function _callee9$(_context9){while(1){switch(_context9.prev=_context9.next){case 0:// Get the cordova plugins\n_cordovaWindow6=_cordovaWindow(),cordova=_cordovaWindow6.cordova;cleanup=function cleanup(){};_context9.prev=2;_context9.next=5;return new Promise(function(resolve,reject){var onCloseTimer=null;// DEFINE ALL THE CALLBACKS =====\n// DEFINE ALL THE CALLBACKS =====\nfunction authEventSeen(){var _a;// Auth event was detected. Resolve this promise and close the extra\n// window if it's still open.\n// Auth event was detected. Resolve this promise and close the extra\n// window if it's still open.\nresolve();var closeBrowserTab=(_a=cordova.plugins.browsertab)===null||_a===void 0?void 0:_a.close;if(typeof closeBrowserTab==='function'){closeBrowserTab();}// Close inappbrowser emebedded webview in iOS7 and 8 case if still\n// open.\n// Close inappbrowser emebedded webview in iOS7 and 8 case if still\n// open.\nif(typeof(iabRef===null||iabRef===void 0?void 0:iabRef.close)==='function'){iabRef.close();}}function resumed(){if(onCloseTimer){// This code already ran; do not rerun.\nreturn;}onCloseTimer=window.setTimeout(function(){// Wait two seeconds after resume then reject.\nreject(_createError(auth,\"redirect-cancelled-by-user\"/* REDIRECT_CANCELLED_BY_USER */));},REDIRECT_TIMEOUT_MS);}function visibilityChanged(){if((document===null||document===void 0?void 0:document.visibilityState)==='visible'){resumed();}}// ATTACH ALL THE LISTENERS =====\n// Listen for the auth event\n// ATTACH ALL THE LISTENERS =====\n// Listen for the auth event\neventListener.addPassiveListener(authEventSeen);// Listen for resume and visibility events\n// Listen for resume and visibility events\ndocument.addEventListener('resume',resumed,false);if(_isAndroid()){document.addEventListener('visibilitychange',visibilityChanged,false);}// SETUP THE CLEANUP FUNCTION =====\n// SETUP THE CLEANUP FUNCTION =====\ncleanup=function cleanup(){eventListener.removePassiveListener(authEventSeen);document.removeEventListener('resume',resumed,false);document.removeEventListener('visibilitychange',visibilityChanged,false);if(onCloseTimer){window.clearTimeout(onCloseTimer);}};});case 5:_context9.prev=5;cleanup();return _context9.finish(5);case 8:case\"end\":return _context9.stop();}}},_callee9,null,[[2,,5,8]]);}));return _waitForAppResume2.apply(this,arguments);}function _checkCordovaConfiguration(auth){var _a,_b,_c,_d,_e,_f,_g,_h,_j,_k;var win=_cordovaWindow();// Check all dependencies installed.\n// https://github.com/nordnet/cordova-universal-links-plugin\n// Note that cordova-universal-links-plugin has been abandoned.\n// A fork with latest fixes is available at:\n// https://www.npmjs.com/package/cordova-universal-links-plugin-fix\n_assert(typeof((_a=win===null||win===void 0?void 0:win.universalLinks)===null||_a===void 0?void 0:_a.subscribe)==='function',auth,\"invalid-cordova-configuration\"/* INVALID_CORDOVA_CONFIGURATION */,{missingPlugin:'cordova-universal-links-plugin-fix'});// https://www.npmjs.com/package/cordova-plugin-buildinfo\n_assert(typeof((_b=win===null||win===void 0?void 0:win.BuildInfo)===null||_b===void 0?void 0:_b.packageName)!=='undefined',auth,\"invalid-cordova-configuration\"/* INVALID_CORDOVA_CONFIGURATION */,{missingPlugin:'cordova-plugin-buildInfo'});// https://github.com/google/cordova-plugin-browsertab\n_assert(typeof((_e=(_d=(_c=win===null||win===void 0?void 0:win.cordova)===null||_c===void 0?void 0:_c.plugins)===null||_d===void 0?void 0:_d.browsertab)===null||_e===void 0?void 0:_e.openUrl)==='function',auth,\"invalid-cordova-configuration\"/* INVALID_CORDOVA_CONFIGURATION */,{missingPlugin:'cordova-plugin-browsertab'});_assert(typeof((_h=(_g=(_f=win===null||win===void 0?void 0:win.cordova)===null||_f===void 0?void 0:_f.plugins)===null||_g===void 0?void 0:_g.browsertab)===null||_h===void 0?void 0:_h.isAvailable)==='function',auth,\"invalid-cordova-configuration\"/* INVALID_CORDOVA_CONFIGURATION */,{missingPlugin:'cordova-plugin-browsertab'});// https://cordova.apache.org/docs/en/latest/reference/cordova-plugin-inappbrowser/\n_assert(typeof((_k=(_j=win===null||win===void 0?void 0:win.cordova)===null||_j===void 0?void 0:_j.InAppBrowser)===null||_k===void 0?void 0:_k.open)==='function',auth,\"invalid-cordova-configuration\"/* INVALID_CORDOVA_CONFIGURATION */,{missingPlugin:'cordova-plugin-inappbrowser'});}/**\r\n * Computes the SHA-256 of a session ID. The SubtleCrypto interface is only\r\n * available in \"secure\" contexts, which covers Cordova (which is served on a file\r\n * protocol).\r\n */function computeSha256(_x8){return _computeSha.apply(this,arguments);}function _computeSha(){_computeSha=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee10(sessionId){var bytes,buf,arr;return _regeneratorRuntime.wrap(function _callee10$(_context10){while(1){switch(_context10.prev=_context10.next){case 0:bytes=stringToArrayBuffer(sessionId);// TODO: For IE11 crypto has a different name and this operation comes back\n//       as an object, not a promise. This is the old proposed standard that\n//       is used by IE11:\n// https://www.w3.org/TR/2013/WD-WebCryptoAPI-20130108/#cryptooperation-interface\n_context10.next=3;return crypto.subtle.digest('SHA-256',bytes);case 3:buf=_context10.sent;arr=Array.from(new Uint8Array(buf));return _context10.abrupt(\"return\",arr.map(function(num){return num.toString(16).padStart(2,'0');}).join(''));case 6:case\"end\":return _context10.stop();}}},_callee10);}));return _computeSha.apply(this,arguments);}function stringToArrayBuffer(str){// This function is only meant to deal with an ASCII charset and makes\n// certain simplifying assumptions.\ndebugAssert(/[0-9a-zA-Z]+/.test(str),'Can only convert alpha-numeric strings');if(typeof TextEncoder!=='undefined'){return new TextEncoder().encode(str);}var buff=new ArrayBuffer(str.length);var view=new Uint8Array(buff);for(var i=0;i<str.length;i++){view[i]=str.charCodeAt(i);}return view;}/**\r\n * @license\r\n * Copyright 2020 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */var SESSION_ID_LENGTH=20;/** Custom AuthEventManager that adds passive listeners to events */var CordovaAuthEventManager=/*#__PURE__*/function(_AuthEventManager){_inherits(CordovaAuthEventManager,_AuthEventManager);var _super=_createSuper(CordovaAuthEventManager);function CordovaAuthEventManager(){var _this;_classCallCheck(this,CordovaAuthEventManager);_this=_super.apply(this,arguments);_this.passiveListeners=new Set();_this.initPromise=new Promise(function(resolve){_this.resolveInialized=resolve;});return _this;}_createClass(CordovaAuthEventManager,[{key:\"addPassiveListener\",value:function addPassiveListener(cb){this.passiveListeners.add(cb);}},{key:\"removePassiveListener\",value:function removePassiveListener(cb){this.passiveListeners.delete(cb);}// In a Cordova environment, this manager can live through multiple redirect\n// operations\n},{key:\"resetRedirect\",value:function resetRedirect(){this.queuedRedirectEvent=null;this.hasHandledPotentialRedirect=false;}/** Override the onEvent method */},{key:\"onEvent\",value:function onEvent(event){this.resolveInialized();this.passiveListeners.forEach(function(cb){return cb(event);});return _get(_getPrototypeOf(CordovaAuthEventManager.prototype),\"onEvent\",this).call(this,event);}},{key:\"initialized\",value:function(){var _initialized=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return this.initPromise;case 2:case\"end\":return _context.stop();}}},_callee,this);}));function initialized(){return _initialized.apply(this,arguments);}return initialized;}()}]);return CordovaAuthEventManager;}(AuthEventManager);/**\r\n * Generates a (partial) {@link AuthEvent}.\r\n */function _generateNewEvent(auth,type){var eventId=arguments.length>2&&arguments[2]!==undefined?arguments[2]:null;return{type:type,eventId:eventId,urlResponse:null,sessionId:generateSessionId(),postBody:null,tenantId:auth.tenantId,error:_createError(auth,\"no-auth-event\"/* NO_AUTH_EVENT */)};}function _savePartialEvent(auth,event){return storage()._set(persistenceKey(auth),event);}function _getAndRemoveEvent(_x9){return _getAndRemoveEvent2.apply(this,arguments);}function _getAndRemoveEvent2(){_getAndRemoveEvent2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee11(auth){var event;return _regeneratorRuntime.wrap(function _callee11$(_context11){while(1){switch(_context11.prev=_context11.next){case 0:_context11.next=2;return storage()._get(persistenceKey(auth));case 2:event=_context11.sent;if(!event){_context11.next=6;break;}_context11.next=6;return storage()._remove(persistenceKey(auth));case 6:return _context11.abrupt(\"return\",event);case 7:case\"end\":return _context11.stop();}}},_callee11);}));return _getAndRemoveEvent2.apply(this,arguments);}function _eventFromPartialAndUrl(partialEvent,url){var _a,_b;// Parse the deep link within the dynamic link URL.\nvar callbackUrl=_getDeepLinkFromCallback(url);// Confirm it is actually a callback URL.\n// Currently the universal link will be of this format:\n// https://<AUTH_DOMAIN>/__/auth/callback<OAUTH_RESPONSE>\n// This is a fake URL but is not intended to take the user anywhere\n// and just redirect to the app.\nif(callbackUrl.includes('/__/auth/callback')){// Check if there is an error in the URL.\n// This mechanism is also used to pass errors back to the app:\n// https://<AUTH_DOMAIN>/__/auth/callback?firebaseError=<STRINGIFIED_ERROR>\nvar params=searchParamsOrEmpty(callbackUrl);// Get the error object corresponding to the stringified error if found.\nvar errorObject=params['firebaseError']?parseJsonOrNull(decodeURIComponent(params['firebaseError'])):null;var code=(_b=(_a=errorObject===null||errorObject===void 0?void 0:errorObject['code'])===null||_a===void 0?void 0:_a.split('auth/'))===null||_b===void 0?void 0:_b[1];var error=code?_createError(code):null;if(error){return{type:partialEvent.type,eventId:partialEvent.eventId,tenantId:partialEvent.tenantId,error:error,urlResponse:null,sessionId:null,postBody:null};}else{return{type:partialEvent.type,eventId:partialEvent.eventId,tenantId:partialEvent.tenantId,sessionId:partialEvent.sessionId,urlResponse:callbackUrl,postBody:null};}}return null;}function generateSessionId(){var chars=[];var allowedChars='1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ';for(var i=0;i<SESSION_ID_LENGTH;i++){var idx=Math.floor(Math.random()*allowedChars.length);chars.push(allowedChars.charAt(idx));}return chars.join('');}function storage(){return _getInstance(browserLocalPersistence);}function persistenceKey(auth){return _persistenceKeyName(\"authEvent\"/* AUTH_EVENT */,auth.config.apiKey,auth.name);}function parseJsonOrNull(json){try{return JSON.parse(json);}catch(e){return null;}}// Exported for testing\nfunction _getDeepLinkFromCallback(url){var params=searchParamsOrEmpty(url);var link=params['link']?decodeURIComponent(params['link']):undefined;// Double link case (automatic redirect)\nvar doubleDeepLink=searchParamsOrEmpty(link)['link'];// iOS custom scheme links.\nvar iOSDeepLink=params['deep_link_id']?decodeURIComponent(params['deep_link_id']):undefined;var iOSDoubleDeepLink=searchParamsOrEmpty(iOSDeepLink)['link'];return iOSDoubleDeepLink||iOSDeepLink||doubleDeepLink||link||url;}/**\r\n * Optimistically tries to get search params from a string, or else returns an\r\n * empty search params object.\r\n */function searchParamsOrEmpty(url){if(!(url===null||url===void 0?void 0:url.includes('?'))){return{};}var _url$split=url.split('?'),_url$split2=_toArray(_url$split),_=_url$split2[0],rest=_url$split2.slice(1);return querystringDecode(rest.join('?'));}/**\r\n * @license\r\n * Copyright 2021 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */ /**\r\n * How long to wait for the initial auth event before concluding no\r\n * redirect pending\r\n */var INITIAL_EVENT_TIMEOUT_MS=500;var CordovaPopupRedirectResolver=/*#__PURE__*/function(){function CordovaPopupRedirectResolver(){_classCallCheck(this,CordovaPopupRedirectResolver);this._redirectPersistence=browserSessionPersistence;this._shouldInitProactively=true;// This is lightweight for Cordova\nthis.eventManagers=new Map();this.originValidationPromises={};this._completeRedirectFn=_getRedirectResult;}_createClass(CordovaPopupRedirectResolver,[{key:\"_initialize\",value:function(){var _initialize2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(auth){var key,manager;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:key=auth._key();manager=this.eventManagers.get(key);if(!manager){manager=new CordovaAuthEventManager(auth);this.eventManagers.set(key,manager);this.attachCallbackListeners(auth,manager);}return _context2.abrupt(\"return\",manager);case 4:case\"end\":return _context2.stop();}}},_callee2,this);}));function _initialize(_x10){return _initialize2.apply(this,arguments);}return _initialize;}()},{key:\"_openPopup\",value:function _openPopup(auth){_fail(auth,\"operation-not-supported-in-this-environment\"/* OPERATION_NOT_SUPPORTED */);}},{key:\"_openRedirect\",value:function(){var _openRedirect2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(auth,provider,authType,eventId){var manager,event,url,iabRef;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_checkCordovaConfiguration(auth);_context3.next=3;return this._initialize(auth);case 3:manager=_context3.sent;_context3.next=6;return manager.initialized();case 6:// Reset the persisted redirect states. This does not matter on Web where\n// the redirect always blows away application state entirely. On Cordova,\n// the app maintains control flow through the redirect.\nmanager.resetRedirect();_clearRedirectOutcomes();_context3.next=10;return this._originValidation(auth);case 10:event=_generateNewEvent(auth,authType,eventId);_context3.next=13;return _savePartialEvent(auth,event);case 13:_context3.next=15;return _generateHandlerUrl(auth,event,provider);case 15:url=_context3.sent;_context3.next=18;return _performRedirect(url);case 18:iabRef=_context3.sent;return _context3.abrupt(\"return\",_waitForAppResume(auth,manager,iabRef));case 20:case\"end\":return _context3.stop();}}},_callee3,this);}));function _openRedirect(_x11,_x12,_x13,_x14){return _openRedirect2.apply(this,arguments);}return _openRedirect;}()},{key:\"_isIframeWebStorageSupported\",value:function _isIframeWebStorageSupported(_auth,_cb){throw new Error('Method not implemented.');}},{key:\"_originValidation\",value:function _originValidation(auth){var key=auth._key();if(!this.originValidationPromises[key]){this.originValidationPromises[key]=_validateOrigin(auth);}return this.originValidationPromises[key];}},{key:\"attachCallbackListeners\",value:function attachCallbackListeners(auth,manager){// Get the global plugins\nvar _cordovaWindow3=_cordovaWindow(),universalLinks=_cordovaWindow3.universalLinks,handleOpenURL=_cordovaWindow3.handleOpenURL,BuildInfo=_cordovaWindow3.BuildInfo;var noEventTimeout=setTimeout(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(){return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_context4.next=2;return _getAndRemoveEvent(auth);case 2:manager.onEvent(generateNoEvent());case 3:case\"end\":return _context4.stop();}}},_callee4);})),INITIAL_EVENT_TIMEOUT_MS);var universalLinksCb=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee5(eventData){var partialEvent,finalEvent;return _regeneratorRuntime.wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:// We have an event so we can clear the no event timeout\nclearTimeout(noEventTimeout);_context5.next=3;return _getAndRemoveEvent(auth);case 3:partialEvent=_context5.sent;finalEvent=null;if(partialEvent&&(eventData===null||eventData===void 0?void 0:eventData['url'])){finalEvent=_eventFromPartialAndUrl(partialEvent,eventData['url']);}// If finalEvent is never filled, trigger with no event\nmanager.onEvent(finalEvent||generateNoEvent());case 7:case\"end\":return _context5.stop();}}},_callee5);}));return function universalLinksCb(_x15){return _ref2.apply(this,arguments);};}();// Universal links subscriber doesn't exist for iOS, so we need to check\nif(typeof universalLinks!=='undefined'&&typeof universalLinks.subscribe==='function'){universalLinks.subscribe(null,universalLinksCb);}// iOS 7 or 8 custom URL schemes.\n// This is also the current default behavior for iOS 9+.\n// For this to work, cordova-plugin-customurlscheme needs to be installed.\n// https://github.com/EddyVerbruggen/Custom-URL-scheme\n// Do not overwrite the existing developer's URL handler.\nvar existingHandleOpenURL=handleOpenURL;var packagePrefix=\"\".concat(BuildInfo.packageName.toLowerCase(),\"://\");_cordovaWindow().handleOpenURL=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee6(url){return _regeneratorRuntime.wrap(function _callee6$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:if(url.toLowerCase().startsWith(packagePrefix)){// We want this intentionally to float\n// eslint-disable-next-line @typescript-eslint/no-floating-promises\nuniversalLinksCb({url:url});}// Call the developer's handler if it is present.\nif(typeof existingHandleOpenURL==='function'){try{existingHandleOpenURL(url);}catch(e){// This is a developer error. Don't stop the flow of the SDK.\nconsole.error(e);}}case 2:case\"end\":return _context6.stop();}}},_callee6);}));return function(_x16){return _ref3.apply(this,arguments);};}();}}]);return CordovaPopupRedirectResolver;}();/**\r\n * An implementation of {@link PopupRedirectResolver} suitable for Cordova\r\n * based applications.\r\n *\r\n * @public\r\n */var cordovaPopupRedirectResolver=CordovaPopupRedirectResolver;function generateNoEvent(){return{type:\"unknown\"/* UNKNOWN */,eventId:null,sessionId:null,urlResponse:null,postBody:null,tenantId:null,error:_createError(\"no-auth-event\"/* NO_AUTH_EVENT */)};}/**\r\n * @license\r\n * Copyright 2017 Google LLC\r\n *\r\n * Licensed under the Apache License, Version 2.0 (the \"License\");\r\n * you may not use this file except in compliance with the License.\r\n * You may obtain a copy of the License at\r\n *\r\n *   http://www.apache.org/licenses/LICENSE-2.0\r\n *\r\n * Unless required by applicable law or agreed to in writing, software\r\n * distributed under the License is distributed on an \"AS IS\" BASIS,\r\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\r\n * See the License for the specific language governing permissions and\r\n * limitations under the License.\r\n */ // This function should only be called by frameworks (e.g. FirebaseUI-web) to log their usage.\n// It is not intended for direct use by developer apps. NO jsdoc here to intentionally leave it out\n// of autogenerated documentation pages to reduce accidental misuse.\nfunction addFrameworkForLogging(auth,framework){_castAuth(auth)._logFramework(framework);}export{addFrameworkForLogging,cordovaPopupRedirectResolver};","map":{"version":3,"sources":["C:\\Users\\asus\\ecommerce project\\ecommerce\\ecommerce-app\\server\\client\\src\\node_modules\\@firebase\\auth\\src\\platform_cordova\\plugins.ts","C:\\Users\\asus\\ecommerce project\\ecommerce\\ecommerce-app\\server\\client\\src\\node_modules\\@firebase\\auth\\src\\platform_cordova\\popup_redirect\\utils.ts","C:\\Users\\asus\\ecommerce project\\ecommerce\\ecommerce-app\\server\\client\\src\\node_modules\\@firebase\\auth\\src\\platform_cordova\\popup_redirect\\events.ts","C:\\Users\\asus\\ecommerce project\\ecommerce\\ecommerce-app\\server\\client\\src\\node_modules\\@firebase\\auth\\src\\platform_cordova\\popup_redirect\\popup_redirect.ts","C:\\Users\\asus\\ecommerce project\\ecommerce\\ecommerce-app\\server\\client\\src\\node_modules\\@firebase\\auth\\internal\\index.ts"],"names":[],"mappings":"qiIAAA;;;;;;;;;;;;;;;WAmDgB,CAAA,c,EAAc,CAC5B,MAAQ,CAAA,MAAR,CACF,CCrDA;;;;;;;;;;;;;;;IAmCA;;;GAIA,GAAM,CAAA,mBAAmB,CAAG,IAA5B,CAEA;;WAGsB,CAAA,mB,gEAsCtB;;gHAtCO,kBACL,IADK,CAEL,KAFK,CAGL,QAHK,sL;AAAA,gBAMiB,cAAc,EAN/B,CAMG,SANH,iBAMG,SANH,CAOL,WAAW,CAAC,KAAK,CAAC,SAAP,CAAkB,wCAAlB,CAAX,CAPK,uBAQuB,CAAA,aAAa,CAAC,KAAK,CAAC,SAAP,CARpC,QAQC,aARD,gBAUC,gBAVD,CAU4C,EAV5C,CAWL,GAAI,MAAM,EAAV,CAAc,C;AAEZ,gBAAgB,CAAC,KAAD,CAAhB,CAA0B,SAAS,CAAC,WAApC,CACD,CAHD,IAGO,IAAI,UAAU,EAAd,CAAkB,C;AAEvB,gBAAgB,CAAC,KAAD,CAAhB,CAA0B,SAAS,CAAC,WAApC,CACD,CAHM,IAGA,CACL,KAAK,CAAC,IAAD,CAAK,6CAAA,6BAAL,CAAL,CACD,C;AAGD,GAAI,SAAS,CAAC,WAAd,CAA2B,CACzB,gBAAgB,CAAC,gBAAD,CAAhB,CAAqC,SAAS,CAAC,WAA/C,CACD,C;AAGD,gBAAgB,CAAC,WAAD,CAAhB,CAAgC,aAAhC,CA3BK,iCA4BE,eAAe,CACpB,IADoB,CAEpB,QAFoB,CAGpB,KAAK,CAAC,IAHc,CAIpB,SAJoB,CAKpB,CAAA,EAAA,CAAA,KAAK,CAAC,OAAN,IAAa,IAAb,EAAa,EAAA,GAAA,IAAA,EAAb,CAAa,EAAb,CAAiB,SALG,CAMpB,gBANoB,CA5BjB,2D,8DAyCe,CAAA,e,0JAAf,kBAA+B,IAA/B,4KACiB,cAAc,EAD/B,CACG,SADH,iBACG,SADH,CAEC,OAFD,CAEoC,EAFpC,CAGL,GAAI,MAAM,EAAV,CAAc,CACZ,OAAO,CAAC,WAAR,CAAsB,SAAS,CAAC,WAAhC,CACD,CAFD,IAEO,IAAI,UAAU,EAAd,CAAkB,CACvB,OAAO,CAAC,kBAAR,CAA6B,SAAS,CAAC,WAAvC,CACD,CAFM,IAEA,CACL,KAAK,CAAC,IAAD,CAAK,6CAAA,6BAAL,CAAL,CACD,C;AATI,uBAYC,CAAA,iBAAiB,CAAC,IAAD,CAAO,OAAP,CAZlB,yD,0DAeS,CAAA,gB,CACd,U,CAAkB,C;AAGlB,oBAAoB,cAAc,EAAlC,CAAQ,OAAR,iBAAQ,OAAR,CAEA,MAAO,IAAI,CAAA,OAAJ,CAAY,SAAA,OAAO,CAAA,CACxB,OAAO,CAAC,OAAR,CAAgB,UAAhB,CAA2B,WAA3B,CAAuC,SAAA,qBAAqB,CAAA,CAC1D,GAAI,CAAA,MAAM,CAA2B,IAArC,CACA,GAAI,qBAAJ,CAA2B,CACzB,OAAO,CAAC,OAAR,CAAgB,UAAhB,CAA2B,OAA3B,CAAmC,UAAnC,EACD,CAFD,IAEO,C;AAEL,MAAM,CAAG,OAAO,CAAC,YAAR,CAAqB,IAArB,CACP,UADO,CAEP,UAAU,GAAK,QAAL,CAAgB,SAFnB,CAGP,cAHO,CAAT,CAKD,CACD,OAAO,CAAC,MAAD,CAAP,CACD,CAbD,EAcD,CAfM,CAAP,CAgBD,CAQD;;;;;WAMsB,CAAA,iB,+DA4EtB;;;;4GA5EO,kBACL,IADK,CAEL,aAFK,CAGL,MAHK,0J;AAAA,gBAMe,cAAc,EAN7B,CAMG,OANH,iBAMG,OANH,CAQD,OARC,CAQS,kBAAA,CAAc,CARvB,yCAUG,IAAI,CAAA,OAAJ,CAAkB,SAAC,OAAD,CAAU,MAAV,CAAgB,CACtC,GAAI,CAAA,YAAY,CAAkB,IAAlC,C;;AAGA,QAAS,CAAA,aAAT,EAAsB,C;;;;AAGpB,OAAO,GACP,GAAM,CAAA,eAAe,CAAG,CAAA,EAAA,CAAA,OAAO,CAAC,OAAR,CAAgB,UAAhB,IAA0B,IAA1B,EAA0B,EAAA,GAAA,IAAA,EAA1B,CAA0B,IAAA,EAA1B,CAA0B,EAAA,CAAE,KAApD,CACA,GAAI,MAAO,CAAA,eAAP,GAA2B,UAA/B,CAA2C,CACzC,eAAe,GAChB,C;;;;AAGD,GAAI,OAAO,MAAM,GAAA,IAAN,EAAA,MAAM,GAAA,IAAA,EAAN,CAAM,IAAA,EAAN,CAAA,MAAM,CAAE,KAAf,IAAyB,UAA7B,CAAyC,CACvC,MAAM,CAAC,KAAP,GACD,CACF,CAED,QAAS,CAAA,OAAT,EAAgB,CACd,GAAI,YAAJ,CAAkB,C;AAEhB,OACD,CAED,YAAY,CAAG,MAAM,CAAC,UAAP,CAAkB,UAAA,C;AAE/B,MAAM,CAAC,YAAY,CAAC,IAAD,CAAK,4BAAA,gCAAL,CAAb,CAAN,CACD,CAHc,CAGZ,mBAHY,CAAf,CAID,CAED,QAAS,CAAA,iBAAT,EAA0B,CACxB,GAAI,CAAA,QAAQ,GAAA,IAAR,EAAA,QAAQ,GAAA,IAAA,EAAR,CAAQ,IAAA,EAAR,CAAA,QAAQ,CAAE,eAAV,IAA8B,SAAlC,CAA6C,CAC3C,OAAO,GACR,CACF,C;;;;AAID,aAAa,CAAC,kBAAd,CAAiC,aAAjC,E;;AAGA,QAAQ,CAAC,gBAAT,CAA0B,QAA1B,CAAoC,OAApC,CAA6C,KAA7C,EACA,GAAI,UAAU,EAAd,CAAkB,CAChB,QAAQ,CAAC,gBAAT,CAA0B,kBAA1B,CAA8C,iBAA9C,CAAiE,KAAjE,EACD,C;;AAGD,OAAO,CAAG,kBAAA,CACR,aAAa,CAAC,qBAAd,CAAoC,aAApC,EACA,QAAQ,CAAC,mBAAT,CAA6B,QAA7B,CAAuC,OAAvC,CAAgD,KAAhD,EACA,QAAQ,CAAC,mBAAT,CACE,kBADF,CAEE,iBAFF,CAGE,KAHF,EAKA,GAAI,YAAJ,CAAkB,CAChB,MAAM,CAAC,YAAP,CAAoB,YAApB,EACD,CACF,CAXD,CAYD,CA5DK,CAVH,yBAwEH,OAAO,GAxEJ,mG,4DAiFS,CAAA,0B,CAA2B,I,CAAkB,C,kCAC3D,GAAM,CAAA,GAAG,CAAG,cAAc,EAA1B,C;;;;;AAMA,OAAO,CACL,OAAO,CAAA,EAAA,CAAA,GAAG,GAAA,IAAH,EAAA,GAAG,GAAA,IAAA,EAAH,CAAG,IAAA,EAAH,CAAA,GAAG,CAAE,cAAL,IAAmB,IAAnB,EAAmB,EAAA,GAAA,IAAA,EAAnB,CAAmB,IAAA,EAAnB,CAAmB,EAAA,CAAE,SAA5B,IAA0C,UADrC,CAEL,IAFK,CAED,+BAAA,mCAFC,CAIL,CACE,aAAa,CAAE,oCADjB,CAJK,CAAP,C;AAUA,OAAO,CACL,OAAO,CAAA,EAAA,CAAA,GAAG,GAAA,IAAH,EAAA,GAAG,GAAA,IAAA,EAAH,CAAG,IAAA,EAAH,CAAA,GAAG,CAAE,SAAL,IAAc,IAAd,EAAc,EAAA,GAAA,IAAA,EAAd,CAAc,IAAA,EAAd,CAAc,EAAA,CAAE,WAAvB,IAAuC,WADlC,CAEL,IAFK,CAED,+BAAA,mCAFC,CAIL,CACE,aAAa,CAAE,0BADjB,CAJK,CAAP,C;AAUA,OAAO,CACL,OAAO,CAAA,EAAA,CAAA,CAAA,EAAA,CAAA,CAAA,EAAA,CAAA,GAAG,GAAA,IAAH,EAAA,GAAG,GAAA,IAAA,EAAH,CAAG,IAAA,EAAH,CAAA,GAAG,CAAE,OAAL,IAAY,IAAZ,EAAY,EAAA,GAAA,IAAA,EAAZ,CAAY,IAAA,EAAZ,CAAY,EAAA,CAAE,OAAd,IAAqB,IAArB,EAAqB,EAAA,GAAA,IAAA,EAArB,CAAqB,IAAA,EAArB,CAAqB,EAAA,CAAE,UAAvB,IAAiC,IAAjC,EAAiC,EAAA,GAAA,IAAA,EAAjC,CAAiC,IAAA,EAAjC,CAAiC,EAAA,CAAE,OAA1C,IAAsD,UADjD,CAEL,IAFK,CAED,+BAAA,mCAFC,CAIL,CACE,aAAa,CAAE,2BADjB,CAJK,CAAP,CAQA,OAAO,CACL,OAAO,CAAA,EAAA,CAAA,CAAA,EAAA,CAAA,CAAA,EAAA,CAAA,GAAG,GAAA,IAAH,EAAA,GAAG,GAAA,IAAA,EAAH,CAAG,IAAA,EAAH,CAAA,GAAG,CAAE,OAAL,IAAY,IAAZ,EAAY,EAAA,GAAA,IAAA,EAAZ,CAAY,IAAA,EAAZ,CAAY,EAAA,CAAE,OAAd,IAAqB,IAArB,EAAqB,EAAA,GAAA,IAAA,EAArB,CAAqB,IAAA,EAArB,CAAqB,EAAA,CAAE,UAAvB,IAAiC,IAAjC,EAAiC,EAAA,GAAA,IAAA,EAAjC,CAAiC,IAAA,EAAjC,CAAiC,EAAA,CAAE,WAA1C,IAA0D,UADrD,CAEL,IAFK,CAED,+BAAA,mCAFC,CAIL,CACE,aAAa,CAAE,2BADjB,CAJK,CAAP,C;AAUA,OAAO,CACL,OAAO,CAAA,EAAA,CAAA,CAAA,EAAA,CAAA,GAAG,GAAA,IAAH,EAAA,GAAG,GAAA,IAAA,EAAH,CAAG,IAAA,EAAH,CAAA,GAAG,CAAE,OAAL,IAAY,IAAZ,EAAY,EAAA,GAAA,IAAA,EAAZ,CAAY,IAAA,EAAZ,CAAY,EAAA,CAAE,YAAd,IAA0B,IAA1B,EAA0B,EAAA,GAAA,IAAA,EAA1B,CAA0B,IAAA,EAA1B,CAA0B,EAAA,CAAE,IAAnC,IAA4C,UADvC,CAEL,IAFK,CAED,+BAAA,mCAFC,CAIL,CACE,aAAa,CAAE,6BADjB,CAJK,CAAP,CAQD,CAED;;;;WAKe,CAAA,a,2IAAf,mBAA6B,SAA7B,4IACQ,KADR,CACgB,mBAAmB,CAAC,SAAD,CADnC,C;;;;AAAA,wBAOoB,CAAA,MAAM,CAAC,MAAP,CAAc,MAAd,CAAqB,SAArB,CAAgC,KAAhC,CAPpB,QAOQ,GAPR,iBAQQ,GARR,CAQc,KAAK,CAAC,IAAN,CAAW,GAAI,CAAA,UAAJ,CAAe,GAAf,CAAX,CARd,mCASS,GAAG,CAAC,GAAJ,CAAQ,SAAA,GAAG,QAAI,CAAA,GAAG,CAAC,QAAJ,CAAa,EAAb,EAAiB,QAAjB,CAA0B,CAA1B,CAA6B,GAA7B,CAAJ,EAAX,EAAkD,IAAlD,CAAuD,EAAvD,CATT,4D,6CAYA,QAAS,CAAA,mBAAT,CAA6B,GAA7B,CAAwC,C;;AAGtC,WAAW,CACT,eAAe,IAAf,CAAoB,GAApB,CADS,CAET,wCAFS,CAAX,CAIA,GAAI,MAAO,CAAA,WAAP,GAAuB,WAA3B,CAAwC,CACtC,MAAO,IAAI,CAAA,WAAJ,GAAkB,MAAlB,CAAyB,GAAzB,CAAP,CACD,CAED,GAAM,CAAA,IAAI,CAAG,GAAI,CAAA,WAAJ,CAAgB,GAAG,CAAC,MAApB,CAAb,CACA,GAAM,CAAA,IAAI,CAAG,GAAI,CAAA,UAAJ,CAAe,IAAf,CAAb,CACA,IAAK,GAAI,CAAA,CAAC,CAAG,CAAb,CAAgB,CAAC,CAAG,GAAG,CAAC,MAAxB,CAAgC,CAAC,EAAjC,CAAqC,CACnC,IAAI,CAAC,CAAD,CAAJ,CAAU,GAAG,CAAC,UAAJ,CAAe,CAAf,CAAV,CACD,CACD,MAAO,CAAA,IAAP,CACF,CClTA;;;;;;;;;;;;;;;GA+BA,GAAM,CAAA,iBAAiB,CAAG,EAA1B,CAEA,oE,GACa,CAAA,uB,gJAAb,kCAAA,yD,mCACmB,MAAA,gBAAA,CAAmB,GAAI,CAAA,GAAJ,EAAnB,CAET,MAAA,WAAA,CAAc,GAAI,CAAA,OAAJ,CAAkB,SAAA,OAAO,CAAA,CAC7C,MAAK,gBAAL,CAAwB,OAAxB,CACD,CAFqB,CAAd,CAHV,aAgCC,C,sEAzBC,4BAAmB,EAAnB,CAA6C,CAC3C,KAAK,gBAAL,CAAsB,GAAtB,CAA0B,EAA1B,EACD,C,qCAED,+BAAsB,EAAtB,CAAgD,CAC9C,KAAK,gBAAL,CAAsB,MAAtB,CAA6B,EAA7B,EACD,C;;6BAID,wBAAa,CACX,KAAK,mBAAL,CAA2B,IAA3B,CACA,KAAK,2BAAL,CAAmC,KAAnC,CACD,C,yDAGD,iBAAQ,KAAR,CAAwB,CACtB,KAAK,gBAAL,GACA,KAAK,gBAAL,CAAsB,OAAtB,CAA8B,SAAA,EAAE,QAAI,CAAA,EAAE,CAAC,KAAD,CAAN,EAAhC,EACA,yFAAqB,KAArB,EACD,C,+GAED,yJACQ,MAAK,WADb,4D,gIA7B2C,gB,EAkC7C;;WAGgB,CAAA,iB,CACd,I,CACA,I,CAC6B,IAA7B,CAAA,OAA6B,2DAAJ,IAAI,CAE7B,MAAO,CACL,IAAI,CAAJ,IADK,CAEL,OAAO,CAAP,OAFK,CAGL,WAAW,CAAE,IAHR,CAIL,SAAS,CAAE,iBAAiB,EAJvB,CAKL,QAAQ,CAAE,IALL,CAML,QAAQ,CAAE,IAAI,CAAC,QANV,CAOL,KAAK,CAAE,YAAY,CAAC,IAAD,CAAK,eAAA,mBAAL,CAPd,CAAP,CASD,C,QAEe,CAAA,iB,CACd,I,CACA,K,CAAgB,CAEhB,MAAO,CAAA,OAAO,GAAG,IAAV,CACL,cAAc,CAAC,IAAD,CADT,CAEJ,KAFI,CAAP,CAID,C,QAEqB,CAAA,kB,mKAAf,mBACL,IADK,4JAGgB,CAAA,OAAO,GAAG,IAAV,CACnB,cAAc,CAAC,IAAD,CADK,CAHhB,QAGC,KAHD,qBAMD,KANC,mDAOG,CAAA,OAAO,GAAG,OAAV,CAAkB,cAAc,CAAC,IAAD,CAAhC,CAPH,0CASE,KATF,4D,6DAYS,CAAA,uB,CACd,Y,CACA,G,CAAW,C;AAGX,GAAM,CAAA,WAAW,CAAG,wBAAwB,CAAC,GAAD,CAA5C,C;;;;;AAMA,GAAI,WAAW,CAAC,QAAZ,CAAqB,mBAArB,CAAJ,CAA+C,C;;;AAI7C,GAAM,CAAA,MAAM,CAAG,mBAAmB,CAAC,WAAD,CAAlC,C;AAEA,GAAM,CAAA,WAAW,CAAG,MAAM,CAAC,eAAD,CAAN,CAChB,eAAe,CAAC,kBAAkB,CAAC,MAAM,CAAC,eAAD,CAAP,CAAnB,CADC,CAEhB,IAFJ,CAGA,GAAM,CAAA,IAAI,CAAG,CAAA,EAAA,CAAA,CAAA,EAAA,CAAA,WAAW,GAAA,IAAX,EAAA,WAAW,GAAA,IAAA,EAAX,CAAW,IAAA,EAAX,CAAA,WAAW,CAAG,MAAH,CAAX,IAAqB,IAArB,EAAqB,EAAA,GAAA,IAAA,EAArB,CAAqB,IAAA,EAArB,CAAqB,EAAA,CAAE,KAAF,CAAQ,OAAR,CAArB,IAAqC,IAArC,EAAqC,EAAA,GAAA,IAAA,EAArC,CAAqC,IAAA,EAArC,CAAqC,EAAA,CAAG,CAAH,CAAlD,CACA,GAAM,CAAA,KAAK,CAAG,IAAI,CAAG,YAAY,CAAC,IAAD,CAAf,CAAwB,IAA1C,CACA,GAAI,KAAJ,CAAW,CACT,MAAO,CACL,IAAI,CAAE,YAAY,CAAC,IADd,CAEL,OAAO,CAAE,YAAY,CAAC,OAFjB,CAGL,QAAQ,CAAE,YAAY,CAAC,QAHlB,CAIL,KAAK,CAAL,KAJK,CAKL,WAAW,CAAE,IALR,CAML,SAAS,CAAE,IANN,CAOL,QAAQ,CAAE,IAPL,CAAP,CASD,CAVD,IAUO,CACL,MAAO,CACL,IAAI,CAAE,YAAY,CAAC,IADd,CAEL,OAAO,CAAE,YAAY,CAAC,OAFjB,CAGL,QAAQ,CAAE,YAAY,CAAC,QAHlB,CAIL,SAAS,CAAE,YAAY,CAAC,SAJnB,CAKL,WAAW,CAAE,WALR,CAML,QAAQ,CAAE,IANL,CAAP,CAQD,CACF,CAED,MAAO,KAAP,CACD,CAED,QAAS,CAAA,iBAAT,EAA0B,CACxB,GAAM,CAAA,KAAK,CAAG,EAAd,CACA,GAAM,CAAA,YAAY,CAChB,gEADF,CAEA,IAAK,GAAI,CAAA,CAAC,CAAG,CAAb,CAAgB,CAAC,CAAG,iBAApB,CAAuC,CAAC,EAAxC,CAA4C,CAC1C,GAAM,CAAA,GAAG,CAAG,IAAI,CAAC,KAAL,CAAW,IAAI,CAAC,MAAL,GAAgB,YAAY,CAAC,MAAxC,CAAZ,CACA,KAAK,CAAC,IAAN,CAAW,YAAY,CAAC,MAAb,CAAoB,GAApB,CAAX,EACD,CACD,MAAO,CAAA,KAAK,CAAC,IAAN,CAAW,EAAX,CAAP,CACD,CAED,QAAS,CAAA,OAAT,EAAgB,CACd,MAAO,CAAA,YAAY,CAAC,uBAAD,CAAnB,CACD,CAED,QAAS,CAAA,cAAT,CAAwB,IAAxB,CAA0C,CACxC,MAAO,CAAA,mBAAmB,CAAA,WAAA,gBAAA,CAAqB,IAAI,CAAC,MAAL,CAAY,MAAjC,CAAyC,IAAI,CAAC,IAA9C,CAA1B,CACD,CAED,QAAS,CAAA,eAAT,CAAyB,IAAzB,CAAqC,CACnC,GAAI,CACF,MAAO,CAAA,IAAI,CAAC,KAAL,CAAW,IAAX,CAAP,CACD,CAAC,MAAO,CAAP,CAAU,CACV,MAAO,KAAP,CACD,CACF,CAED;QACgB,CAAA,wB,CAAyB,G,CAAW,CAClD,GAAM,CAAA,MAAM,CAAG,mBAAmB,CAAC,GAAD,CAAlC,CACA,GAAM,CAAA,IAAI,CAAG,MAAM,CAAC,MAAD,CAAN,CAAiB,kBAAkB,CAAC,MAAM,CAAC,MAAD,CAAP,CAAnC,CAAsD,SAAnE,C;AAEA,GAAM,CAAA,cAAc,CAAG,mBAAmB,CAAC,IAAD,CAAnB,CAA0B,MAA1B,CAAvB,C;AAEA,GAAM,CAAA,WAAW,CAAG,MAAM,CAAC,cAAD,CAAN,CAChB,kBAAkB,CAAC,MAAM,CAAC,cAAD,CAAP,CADF,CAEhB,SAFJ,CAGA,GAAM,CAAA,iBAAiB,CAAG,mBAAmB,CAAC,WAAD,CAAnB,CAAiC,MAAjC,CAA1B,CACA,MAAO,CAAA,iBAAiB,EAAI,WAArB,EAAoC,cAApC,EAAsD,IAAtD,EAA8D,GAArE,CACD,CAED;;;GAIA,QAAS,CAAA,mBAAT,CAA6B,GAA7B,CAAoD,CAClD,GAAI,EAAC,GAAG,GAAA,IAAH,EAAA,GAAG,GAAA,IAAA,EAAH,CAAG,IAAA,EAAH,CAAA,GAAG,CAAE,QAAL,CAAc,GAAd,CAAD,CAAJ,CAAyB,CACvB,MAAO,EAAP,CACD,CAED,eAAqB,GAAG,CAAC,KAAJ,CAAU,GAAV,CAArB,kCAAO,CAAP,gBAAa,IAAb,sBACA,MAAO,CAAA,iBAAiB,CAAC,IAAI,CAAC,IAAL,CAAU,GAAV,CAAD,CAAxB,CACF,CChNA;;;;;;;;;;;;;;;IA+CA;;;GAIA,GAAM,CAAA,wBAAwB,CAAG,GAAjC,C,GAEM,CAAA,4B,yBAAN,uCAAA,oDACW,KAAA,oBAAA,CAAuB,yBAAvB,CACA,KAAA,sBAAA,CAAyB,IAAzB,CAA8B;AACtB,KAAA,aAAA,CAAgB,GAAI,CAAA,GAAJ,EAAhB,CACA,KAAA,wBAAA,CAA0D,EAA1D,CAEjB,KAAA,mBAAA,CAAsB,kBAAtB,CAwHD,C,wJAtHC,kBAAkB,IAAlB,sIACQ,GADR,CACc,IAAI,CAAC,IAAL,EADd,CAEM,OAFN,CAEgB,KAAK,aAAL,CAAmB,GAAnB,CAAuB,GAAvB,CAFhB,CAGE,GAAI,CAAC,OAAL,CAAc,CACZ,OAAO,CAAG,GAAI,CAAA,uBAAJ,CAA4B,IAA5B,CAAV,CACA,KAAK,aAAL,CAAmB,GAAnB,CAAuB,GAAvB,CAA4B,OAA5B,EACA,KAAK,uBAAL,CAA6B,IAA7B,CAAmC,OAAnC,EACD,CAPH,iCAQS,OART,+D,yHAWA,oBAAW,IAAX,CAA6B,CAC3B,KAAK,CAAC,IAAD,CAAK,6CAAA,6BAAL,CAAL,CACD,C,mHAED,kBACE,IADF,CAEE,QAFF,CAGE,QAHF,CAIE,OAJF,mJAME,0BAA0B,CAAC,IAAD,CAA1B,CANF,uBAOwB,MAAK,WAAL,CAAiB,IAAjB,CAPxB,QAOQ,OAPR,uCAQQ,CAAA,OAAO,CAAC,WAAR,EARR,Q;;;AAaE,OAAO,CAAC,aAAR,GACA,sBAAsB,GAdxB,wBAgBQ,MAAK,iBAAL,CAAuB,IAAvB,CAhBR,SAkBQ,KAlBR,CAkBgB,iBAAiB,CAAC,IAAD,CAAO,QAAP,CAAiB,OAAjB,CAlBjC,yBAmBQ,CAAA,iBAAiB,CAAC,IAAD,CAAO,KAAP,CAnBzB,iCAoBoB,CAAA,mBAAmB,CAAC,IAAD,CAAO,KAAP,CAAc,QAAd,CApBvC,SAoBQ,GApBR,wCAqBuB,CAAA,gBAAgB,CAAC,GAAD,CArBvC,SAqBQ,MArBR,iDAsBS,iBAAiB,CAAC,IAAD,CAAO,OAAP,CAAgB,MAAhB,CAtB1B,gE,gKAyBA,sCACE,KADF,CAEE,GAFF,CAEoC,CAElC,KAAM,IAAI,CAAA,KAAJ,CAAU,yBAAV,CAAN,CACD,C,iCAED,2BAAkB,IAAlB,CAAoC,CAClC,GAAM,CAAA,GAAG,CAAG,IAAI,CAAC,IAAL,EAAZ,CACA,GAAI,CAAC,KAAK,wBAAL,CAA8B,GAA9B,CAAL,CAAyC,CACvC,KAAK,wBAAL,CAA8B,GAA9B,EAAqC,eAAe,CAAC,IAAD,CAApD,CACD,CAED,MAAO,MAAK,wBAAL,CAA8B,GAA9B,CAAP,CACD,C,uCAEO,iCACN,IADM,CAEN,OAFM,CAEmB,C;AAGzB,oBAAqD,cAAc,EAAnE,CAAQ,cAAR,iBAAQ,cAAR,CAAwB,aAAxB,iBAAwB,aAAxB,CAAuC,SAAvC,iBAAuC,SAAvC,CAEA,GAAM,CAAA,cAAc,CAAG,UAAU,sEAAC,+JAG1B,CAAA,kBAAkB,CAAC,IAAD,CAHQ,QAIhC,OAAO,CAAC,OAAR,CAAgB,eAAe,EAA/B,EAJgC,wDAAD,GAK9B,wBAL8B,CAAjC,CAOA,GAAM,CAAA,gBAAgB,2FAAG,kBACvB,SADuB,kJ;AAIvB,YAAY,CAAC,cAAD,CAAZ,CAJuB,uBAMI,CAAA,kBAAkB,CAAC,IAAD,CANtB,QAMjB,YANiB,gBAOnB,UAPmB,CAOY,IAPZ,CAQvB,GAAI,YAAY,GAAI,SAAS,GAAA,IAAT,EAAA,SAAS,GAAA,IAAA,EAAT,CAAS,IAAA,EAAT,CAAA,SAAS,CAAG,KAAH,CAAb,CAAhB,CAAwC,CACtC,UAAU,CAAG,uBAAuB,CAAC,YAAD,CAAe,SAAS,CAAC,KAAD,CAAxB,CAApC,CACD,C;AAGD,OAAO,CAAC,OAAR,CAAgB,UAAU,EAAI,eAAe,EAA7C,EAbuB,wDAAH,kBAAhB,CAAA,gBAAgB,+CAAtB,C;AAiBA,GACE,MAAO,CAAA,cAAP,GAA0B,WAA1B,EACA,MAAO,CAAA,cAAc,CAAC,SAAtB,GAAoC,UAFtC,CAGE,CACA,cAAc,CAAC,SAAf,CAAyB,IAAzB,CAA+B,gBAA/B,EACD,C;;;;;AAOD,GAAM,CAAA,qBAAqB,CAAG,aAA9B,CACA,GAAM,CAAA,aAAa,WAAM,SAAS,CAAC,WAAV,CAAsB,WAAtB,EAAN,OAAnB,CACA,cAAc,GAAG,aAAjB,2FAAiC,kBAAM,GAAN,sHAC/B,GAAI,GAAG,CAAC,WAAJ,GAAkB,UAAlB,CAA6B,aAA7B,CAAJ,CAAiD,C;;AAG/C,gBAAgB,CAAC,CAAE,GAAG,CAAH,GAAF,CAAD,CAAhB,CACD,C;AAED,GAAI,MAAO,CAAA,qBAAP,GAAiC,UAArC,CAAiD,CAC/C,GAAI,CACF,qBAAqB,CAAC,GAAD,CAArB,CACD,CAAC,MAAO,CAAP,CAAU,C;AAEV,OAAO,CAAC,KAAR,CAAc,CAAd,EACD,CACF,CAd8B,wDAAjC,kEAgBD,C,4CAGH;;;;;MAMa,CAAA,4BAA4B,CACvC,4B,CAEF,QAAS,CAAA,eAAT,EAAwB,CACtB,MAAO,CACL,IAAI,CAAA,SAAA,aADC,CAEL,OAAO,CAAE,IAFJ,CAGL,SAAS,CAAE,IAHN,CAIL,WAAW,CAAE,IAJR,CAKL,QAAQ,CAAE,IALL,CAML,QAAQ,CAAE,IANL,CAOL,KAAK,CAAE,YAAY,CAAA,eAAA,mBAAA,CAPd,CAAP,CASF,CCxMA;;;;;;;;;;;;;;;IAmDA;AACA;AACA;QACgB,CAAA,sB,CAAuB,I,CAAY,S,CAAiB,CAClE,SAAS,CAAC,IAAD,CAAT,CAAgB,aAAhB,CAA8B,SAA9B,EACF,C","sourcesContent":["/**\n * @license\n * Copyright 2021 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nexport interface CordovaWindow extends Window {\n  cordova: {\n    plugins: {\n      browsertab: {\n        isAvailable(cb: (available: boolean) => void): void;\n        openUrl(url: string): void;\n        close(): void;\n      };\n    };\n\n    InAppBrowser: {\n      open(url: string, target: string, options: string): InAppBrowserRef;\n    };\n  };\n\n  universalLinks: {\n    subscribe(\n      n: null,\n      cb: (event: Record<string, string> | null) => void\n    ): void;\n  };\n\n  BuildInfo: {\n    readonly packageName: string;\n    readonly displayName: string;\n  };\n\n  handleOpenURL(url: string): void;\n}\n\nexport interface InAppBrowserRef {\n  close?: () => void;\n}\n\nexport function _cordovaWindow(): CordovaWindow {\n  return (window as unknown) as CordovaWindow;\n}\n","/**\n * @license\n * Copyright 2020 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { AuthProvider } from '../../model/public_types';\nimport { AuthErrorCode } from '../../core/errors';\nimport {\n  debugAssert,\n  _assert,\n  _createError,\n  _fail\n} from '../../core/util/assert';\nimport { _isAndroid, _isIOS, _isIOS7Or8 } from '../../core/util/browser';\nimport { _getRedirectUrl } from '../../core/util/handler';\nimport { AuthInternal } from '../../model/auth';\nimport { AuthEvent } from '../../model/popup_redirect';\nimport { InAppBrowserRef, _cordovaWindow } from '../plugins';\nimport {\n  GetProjectConfigRequest,\n  _getProjectConfig\n} from '../../api/project_config/get_project_config';\n\n/**\n * How long to wait after the app comes back into focus before concluding that\n * the user closed the sign in tab.\n */\nconst REDIRECT_TIMEOUT_MS = 2000;\n\n/**\n * Generates the URL for the OAuth handler.\n */\nexport async function _generateHandlerUrl(\n  auth: AuthInternal,\n  event: AuthEvent,\n  provider: AuthProvider\n): Promise<string> {\n  // Get the cordova plugins\n  const { BuildInfo } = _cordovaWindow();\n  debugAssert(event.sessionId, 'AuthEvent did not contain a session ID');\n  const sessionDigest = await computeSha256(event.sessionId);\n\n  const additionalParams: Record<string, string> = {};\n  if (_isIOS()) {\n    // iOS app identifier\n    additionalParams['ibi'] = BuildInfo.packageName;\n  } else if (_isAndroid()) {\n    // Android app identifier\n    additionalParams['apn'] = BuildInfo.packageName;\n  } else {\n    _fail(auth, AuthErrorCode.OPERATION_NOT_SUPPORTED);\n  }\n\n  // Add the display name if available\n  if (BuildInfo.displayName) {\n    additionalParams['appDisplayName'] = BuildInfo.displayName;\n  }\n\n  // Attached the hashed session ID\n  additionalParams['sessionId'] = sessionDigest;\n  return _getRedirectUrl(\n    auth,\n    provider,\n    event.type,\n    undefined,\n    event.eventId ?? undefined,\n    additionalParams\n  );\n}\n\n/**\n * Validates that this app is valid for this project configuration\n */\nexport async function _validateOrigin(auth: AuthInternal): Promise<void> {\n  const { BuildInfo } = _cordovaWindow();\n  const request: GetProjectConfigRequest = {};\n  if (_isIOS()) {\n    request.iosBundleId = BuildInfo.packageName;\n  } else if (_isAndroid()) {\n    request.androidPackageName = BuildInfo.packageName;\n  } else {\n    _fail(auth, AuthErrorCode.OPERATION_NOT_SUPPORTED);\n  }\n\n  // Will fail automatically if package name is not authorized\n  await _getProjectConfig(auth, request);\n}\n\nexport function _performRedirect(\n  handlerUrl: string\n): Promise<InAppBrowserRef | null> {\n  // Get the cordova plugins\n  const { cordova } = _cordovaWindow();\n\n  return new Promise(resolve => {\n    cordova.plugins.browsertab.isAvailable(browserTabIsAvailable => {\n      let iabRef: InAppBrowserRef | null = null;\n      if (browserTabIsAvailable) {\n        cordova.plugins.browsertab.openUrl(handlerUrl);\n      } else {\n        // TODO: Return the inappbrowser ref that's returned from the open call\n        iabRef = cordova.InAppBrowser.open(\n          handlerUrl,\n          _isIOS7Or8() ? '_blank' : '_system',\n          'location=yes'\n        );\n      }\n      resolve(iabRef);\n    });\n  });\n}\n\n// Thin interface wrapper to avoid circular dependency with ./events module\ninterface PassiveAuthEventListener {\n  addPassiveListener(cb: () => void): void;\n  removePassiveListener(cb: () => void): void;\n}\n\n/**\n * This function waits for app activity to be seen before resolving. It does\n * this by attaching listeners to various dom events. Once the app is determined\n * to be visible, this promise resolves. AFTER that resolution, the listeners\n * are detached and any browser tabs left open will be closed.\n */\nexport async function _waitForAppResume(\n  auth: AuthInternal,\n  eventListener: PassiveAuthEventListener,\n  iabRef: InAppBrowserRef | null\n): Promise<void> {\n  // Get the cordova plugins\n  const { cordova } = _cordovaWindow();\n\n  let cleanup = (): void => {};\n  try {\n    await new Promise<void>((resolve, reject) => {\n      let onCloseTimer: number | null = null;\n\n      // DEFINE ALL THE CALLBACKS =====\n      function authEventSeen(): void {\n        // Auth event was detected. Resolve this promise and close the extra\n        // window if it's still open.\n        resolve();\n        const closeBrowserTab = cordova.plugins.browsertab?.close;\n        if (typeof closeBrowserTab === 'function') {\n          closeBrowserTab();\n        }\n        // Close inappbrowser emebedded webview in iOS7 and 8 case if still\n        // open.\n        if (typeof iabRef?.close === 'function') {\n          iabRef.close();\n        }\n      }\n\n      function resumed(): void {\n        if (onCloseTimer) {\n          // This code already ran; do not rerun.\n          return;\n        }\n\n        onCloseTimer = window.setTimeout(() => {\n          // Wait two seeconds after resume then reject.\n          reject(_createError(auth, AuthErrorCode.REDIRECT_CANCELLED_BY_USER));\n        }, REDIRECT_TIMEOUT_MS);\n      }\n\n      function visibilityChanged(): void {\n        if (document?.visibilityState === 'visible') {\n          resumed();\n        }\n      }\n\n      // ATTACH ALL THE LISTENERS =====\n      // Listen for the auth event\n      eventListener.addPassiveListener(authEventSeen);\n\n      // Listen for resume and visibility events\n      document.addEventListener('resume', resumed, false);\n      if (_isAndroid()) {\n        document.addEventListener('visibilitychange', visibilityChanged, false);\n      }\n\n      // SETUP THE CLEANUP FUNCTION =====\n      cleanup = () => {\n        eventListener.removePassiveListener(authEventSeen);\n        document.removeEventListener('resume', resumed, false);\n        document.removeEventListener(\n          'visibilitychange',\n          visibilityChanged,\n          false\n        );\n        if (onCloseTimer) {\n          window.clearTimeout(onCloseTimer);\n        }\n      };\n    });\n  } finally {\n    cleanup();\n  }\n}\n\n/**\n * Checks the configuration of the Cordova environment. This has no side effect\n * if the configuration is correct; otherwise it throws an error with the\n * missing plugin.\n */\nexport function _checkCordovaConfiguration(auth: AuthInternal): void {\n  const win = _cordovaWindow();\n  // Check all dependencies installed.\n  // https://github.com/nordnet/cordova-universal-links-plugin\n  // Note that cordova-universal-links-plugin has been abandoned.\n  // A fork with latest fixes is available at:\n  // https://www.npmjs.com/package/cordova-universal-links-plugin-fix\n  _assert(\n    typeof win?.universalLinks?.subscribe === 'function',\n    auth,\n    AuthErrorCode.INVALID_CORDOVA_CONFIGURATION,\n    {\n      missingPlugin: 'cordova-universal-links-plugin-fix'\n    }\n  );\n\n  // https://www.npmjs.com/package/cordova-plugin-buildinfo\n  _assert(\n    typeof win?.BuildInfo?.packageName !== 'undefined',\n    auth,\n    AuthErrorCode.INVALID_CORDOVA_CONFIGURATION,\n    {\n      missingPlugin: 'cordova-plugin-buildInfo'\n    }\n  );\n\n  // https://github.com/google/cordova-plugin-browsertab\n  _assert(\n    typeof win?.cordova?.plugins?.browsertab?.openUrl === 'function',\n    auth,\n    AuthErrorCode.INVALID_CORDOVA_CONFIGURATION,\n    {\n      missingPlugin: 'cordova-plugin-browsertab'\n    }\n  );\n  _assert(\n    typeof win?.cordova?.plugins?.browsertab?.isAvailable === 'function',\n    auth,\n    AuthErrorCode.INVALID_CORDOVA_CONFIGURATION,\n    {\n      missingPlugin: 'cordova-plugin-browsertab'\n    }\n  );\n\n  // https://cordova.apache.org/docs/en/latest/reference/cordova-plugin-inappbrowser/\n  _assert(\n    typeof win?.cordova?.InAppBrowser?.open === 'function',\n    auth,\n    AuthErrorCode.INVALID_CORDOVA_CONFIGURATION,\n    {\n      missingPlugin: 'cordova-plugin-inappbrowser'\n    }\n  );\n}\n\n/**\n * Computes the SHA-256 of a session ID. The SubtleCrypto interface is only\n * available in \"secure\" contexts, which covers Cordova (which is served on a file\n * protocol).\n */\nasync function computeSha256(sessionId: string): Promise<string> {\n  const bytes = stringToArrayBuffer(sessionId);\n\n  // TODO: For IE11 crypto has a different name and this operation comes back\n  //       as an object, not a promise. This is the old proposed standard that\n  //       is used by IE11:\n  // https://www.w3.org/TR/2013/WD-WebCryptoAPI-20130108/#cryptooperation-interface\n  const buf = await crypto.subtle.digest('SHA-256', bytes);\n  const arr = Array.from(new Uint8Array(buf));\n  return arr.map(num => num.toString(16).padStart(2, '0')).join('');\n}\n\nfunction stringToArrayBuffer(str: string): Uint8Array {\n  // This function is only meant to deal with an ASCII charset and makes\n  // certain simplifying assumptions.\n  debugAssert(\n    /[0-9a-zA-Z]+/.test(str),\n    'Can only convert alpha-numeric strings'\n  );\n  if (typeof TextEncoder !== 'undefined') {\n    return new TextEncoder().encode(str);\n  }\n\n  const buff = new ArrayBuffer(str.length);\n  const view = new Uint8Array(buff);\n  for (let i = 0; i < str.length; i++) {\n    view[i] = str.charCodeAt(i);\n  }\n  return view;\n}\n","/**\n * @license\n * Copyright 2020 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { querystringDecode } from '@firebase/util';\nimport { AuthEventManager } from '../../core/auth/auth_event_manager';\nimport { AuthErrorCode } from '../../core/errors';\nimport { PersistedBlob, PersistenceInternal } from '../../core/persistence';\nimport {\n  KeyName,\n  _persistenceKeyName\n} from '../../core/persistence/persistence_user_manager';\nimport { _createError } from '../../core/util/assert';\nimport { _getInstance } from '../../core/util/instantiator';\nimport { AuthInternal } from '../../model/auth';\nimport { AuthEvent, AuthEventType } from '../../model/popup_redirect';\nimport { browserLocalPersistence } from '../../platform_browser/persistence/local_storage';\n\nconst SESSION_ID_LENGTH = 20;\n\n/** Custom AuthEventManager that adds passive listeners to events */\nexport class CordovaAuthEventManager extends AuthEventManager {\n  private readonly passiveListeners = new Set<(e: AuthEvent) => void>();\n  private resolveInialized!: () => void;\n  private initPromise = new Promise<void>(resolve => {\n    this.resolveInialized = resolve;\n  });\n\n  addPassiveListener(cb: (e: AuthEvent) => void): void {\n    this.passiveListeners.add(cb);\n  }\n\n  removePassiveListener(cb: (e: AuthEvent) => void): void {\n    this.passiveListeners.delete(cb);\n  }\n\n  // In a Cordova environment, this manager can live through multiple redirect\n  // operations\n  resetRedirect(): void {\n    this.queuedRedirectEvent = null;\n    this.hasHandledPotentialRedirect = false;\n  }\n\n  /** Override the onEvent method */\n  onEvent(event: AuthEvent): boolean {\n    this.resolveInialized();\n    this.passiveListeners.forEach(cb => cb(event));\n    return super.onEvent(event);\n  }\n\n  async initialized(): Promise<void> {\n    await this.initPromise;\n  }\n}\n\n/**\n * Generates a (partial) {@link AuthEvent}.\n */\nexport function _generateNewEvent(\n  auth: AuthInternal,\n  type: AuthEventType,\n  eventId: string | null = null\n): AuthEvent {\n  return {\n    type,\n    eventId,\n    urlResponse: null,\n    sessionId: generateSessionId(),\n    postBody: null,\n    tenantId: auth.tenantId,\n    error: _createError(auth, AuthErrorCode.NO_AUTH_EVENT)\n  };\n}\n\nexport function _savePartialEvent(\n  auth: AuthInternal,\n  event: AuthEvent\n): Promise<void> {\n  return storage()._set(\n    persistenceKey(auth),\n    (event as object) as PersistedBlob\n  );\n}\n\nexport async function _getAndRemoveEvent(\n  auth: AuthInternal\n): Promise<AuthEvent | null> {\n  const event = (await storage()._get(\n    persistenceKey(auth)\n  )) as AuthEvent | null;\n  if (event) {\n    await storage()._remove(persistenceKey(auth));\n  }\n  return event;\n}\n\nexport function _eventFromPartialAndUrl(\n  partialEvent: AuthEvent,\n  url: string\n): AuthEvent | null {\n  // Parse the deep link within the dynamic link URL.\n  const callbackUrl = _getDeepLinkFromCallback(url);\n  // Confirm it is actually a callback URL.\n  // Currently the universal link will be of this format:\n  // https://<AUTH_DOMAIN>/__/auth/callback<OAUTH_RESPONSE>\n  // This is a fake URL but is not intended to take the user anywhere\n  // and just redirect to the app.\n  if (callbackUrl.includes('/__/auth/callback')) {\n    // Check if there is an error in the URL.\n    // This mechanism is also used to pass errors back to the app:\n    // https://<AUTH_DOMAIN>/__/auth/callback?firebaseError=<STRINGIFIED_ERROR>\n    const params = searchParamsOrEmpty(callbackUrl);\n    // Get the error object corresponding to the stringified error if found.\n    const errorObject = params['firebaseError']\n      ? parseJsonOrNull(decodeURIComponent(params['firebaseError']))\n      : null;\n    const code = errorObject?.['code']?.split('auth/')?.[1];\n    const error = code ? _createError(code) : null;\n    if (error) {\n      return {\n        type: partialEvent.type,\n        eventId: partialEvent.eventId,\n        tenantId: partialEvent.tenantId,\n        error,\n        urlResponse: null,\n        sessionId: null,\n        postBody: null\n      };\n    } else {\n      return {\n        type: partialEvent.type,\n        eventId: partialEvent.eventId,\n        tenantId: partialEvent.tenantId,\n        sessionId: partialEvent.sessionId,\n        urlResponse: callbackUrl,\n        postBody: null\n      };\n    }\n  }\n\n  return null;\n}\n\nfunction generateSessionId(): string {\n  const chars = [];\n  const allowedChars =\n    '1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ';\n  for (let i = 0; i < SESSION_ID_LENGTH; i++) {\n    const idx = Math.floor(Math.random() * allowedChars.length);\n    chars.push(allowedChars.charAt(idx));\n  }\n  return chars.join('');\n}\n\nfunction storage(): PersistenceInternal {\n  return _getInstance(browserLocalPersistence);\n}\n\nfunction persistenceKey(auth: AuthInternal): string {\n  return _persistenceKeyName(KeyName.AUTH_EVENT, auth.config.apiKey, auth.name);\n}\n\nfunction parseJsonOrNull(json: string): ReturnType<typeof JSON.parse> | null {\n  try {\n    return JSON.parse(json);\n  } catch (e) {\n    return null;\n  }\n}\n\n// Exported for testing\nexport function _getDeepLinkFromCallback(url: string): string {\n  const params = searchParamsOrEmpty(url);\n  const link = params['link'] ? decodeURIComponent(params['link']) : undefined;\n  // Double link case (automatic redirect)\n  const doubleDeepLink = searchParamsOrEmpty(link)['link'];\n  // iOS custom scheme links.\n  const iOSDeepLink = params['deep_link_id']\n    ? decodeURIComponent(params['deep_link_id'])\n    : undefined;\n  const iOSDoubleDeepLink = searchParamsOrEmpty(iOSDeepLink)['link'];\n  return iOSDoubleDeepLink || iOSDeepLink || doubleDeepLink || link || url;\n}\n\n/**\n * Optimistically tries to get search params from a string, or else returns an\n * empty search params object.\n */\nfunction searchParamsOrEmpty(url: string | undefined): Record<string, string> {\n  if (!url?.includes('?')) {\n    return {};\n  }\n\n  const [_, ...rest] = url.split('?');\n  return querystringDecode(rest.join('?')) as Record<string, string>;\n}\n","/**\n * @license\n * Copyright 2021 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { AuthProvider, PopupRedirectResolver } from '../../model/public_types';\nimport { browserSessionPersistence } from '../../platform_browser/persistence/session_storage';\nimport { AuthInternal } from '../../model/auth';\nimport {\n  AuthEvent,\n  AuthEventType,\n  PopupRedirectResolverInternal\n} from '../../model/popup_redirect';\nimport { AuthPopup } from '../../platform_browser/util/popup';\nimport { _createError, _fail } from '../../core/util/assert';\nimport { AuthErrorCode } from '../../core/errors';\nimport {\n  _checkCordovaConfiguration,\n  _generateHandlerUrl,\n  _performRedirect,\n  _validateOrigin,\n  _waitForAppResume\n} from './utils';\nimport {\n  CordovaAuthEventManager,\n  _eventFromPartialAndUrl,\n  _generateNewEvent,\n  _getAndRemoveEvent,\n  _savePartialEvent\n} from './events';\nimport { AuthEventManager } from '../../core/auth/auth_event_manager';\nimport { _getRedirectResult } from '../../platform_browser/strategies/redirect';\nimport { _clearRedirectOutcomes } from '../../core/strategies/redirect';\nimport { _cordovaWindow } from '../plugins';\n\n/**\n * How long to wait for the initial auth event before concluding no\n * redirect pending\n */\nconst INITIAL_EVENT_TIMEOUT_MS = 500;\n\nclass CordovaPopupRedirectResolver implements PopupRedirectResolverInternal {\n  readonly _redirectPersistence = browserSessionPersistence;\n  readonly _shouldInitProactively = true; // This is lightweight for Cordova\n  private readonly eventManagers = new Map<string, CordovaAuthEventManager>();\n  private readonly originValidationPromises: Record<string, Promise<void>> = {};\n\n  _completeRedirectFn = _getRedirectResult;\n\n  async _initialize(auth: AuthInternal): Promise<CordovaAuthEventManager> {\n    const key = auth._key();\n    let manager = this.eventManagers.get(key);\n    if (!manager) {\n      manager = new CordovaAuthEventManager(auth);\n      this.eventManagers.set(key, manager);\n      this.attachCallbackListeners(auth, manager);\n    }\n    return manager;\n  }\n\n  _openPopup(auth: AuthInternal): Promise<AuthPopup> {\n    _fail(auth, AuthErrorCode.OPERATION_NOT_SUPPORTED);\n  }\n\n  async _openRedirect(\n    auth: AuthInternal,\n    provider: AuthProvider,\n    authType: AuthEventType,\n    eventId?: string\n  ): Promise<void> {\n    _checkCordovaConfiguration(auth);\n    const manager = await this._initialize(auth);\n    await manager.initialized();\n\n    // Reset the persisted redirect states. This does not matter on Web where\n    // the redirect always blows away application state entirely. On Cordova,\n    // the app maintains control flow through the redirect.\n    manager.resetRedirect();\n    _clearRedirectOutcomes();\n\n    await this._originValidation(auth);\n\n    const event = _generateNewEvent(auth, authType, eventId);\n    await _savePartialEvent(auth, event);\n    const url = await _generateHandlerUrl(auth, event, provider);\n    const iabRef = await _performRedirect(url);\n    return _waitForAppResume(auth, manager, iabRef);\n  }\n\n  _isIframeWebStorageSupported(\n    _auth: AuthInternal,\n    _cb: (support: boolean) => unknown\n  ): void {\n    throw new Error('Method not implemented.');\n  }\n\n  _originValidation(auth: AuthInternal): Promise<void> {\n    const key = auth._key();\n    if (!this.originValidationPromises[key]) {\n      this.originValidationPromises[key] = _validateOrigin(auth);\n    }\n\n    return this.originValidationPromises[key];\n  }\n\n  private attachCallbackListeners(\n    auth: AuthInternal,\n    manager: AuthEventManager\n  ): void {\n    // Get the global plugins\n    const { universalLinks, handleOpenURL, BuildInfo } = _cordovaWindow();\n\n    const noEventTimeout = setTimeout(async () => {\n      // We didn't see that initial event. Clear any pending object and\n      // dispatch no event\n      await _getAndRemoveEvent(auth);\n      manager.onEvent(generateNoEvent());\n    }, INITIAL_EVENT_TIMEOUT_MS);\n\n    const universalLinksCb = async (\n      eventData: Record<string, string> | null\n    ): Promise<void> => {\n      // We have an event so we can clear the no event timeout\n      clearTimeout(noEventTimeout);\n\n      const partialEvent = await _getAndRemoveEvent(auth);\n      let finalEvent: AuthEvent | null = null;\n      if (partialEvent && eventData?.['url']) {\n        finalEvent = _eventFromPartialAndUrl(partialEvent, eventData['url']);\n      }\n\n      // If finalEvent is never filled, trigger with no event\n      manager.onEvent(finalEvent || generateNoEvent());\n    };\n\n    // Universal links subscriber doesn't exist for iOS, so we need to check\n    if (\n      typeof universalLinks !== 'undefined' &&\n      typeof universalLinks.subscribe === 'function'\n    ) {\n      universalLinks.subscribe(null, universalLinksCb);\n    }\n\n    // iOS 7 or 8 custom URL schemes.\n    // This is also the current default behavior for iOS 9+.\n    // For this to work, cordova-plugin-customurlscheme needs to be installed.\n    // https://github.com/EddyVerbruggen/Custom-URL-scheme\n    // Do not overwrite the existing developer's URL handler.\n    const existingHandleOpenURL = handleOpenURL;\n    const packagePrefix = `${BuildInfo.packageName.toLowerCase()}://`;\n    _cordovaWindow().handleOpenURL = async url => {\n      if (url.toLowerCase().startsWith(packagePrefix)) {\n        // We want this intentionally to float\n        // eslint-disable-next-line @typescript-eslint/no-floating-promises\n        universalLinksCb({ url });\n      }\n      // Call the developer's handler if it is present.\n      if (typeof existingHandleOpenURL === 'function') {\n        try {\n          existingHandleOpenURL(url);\n        } catch (e) {\n          // This is a developer error. Don't stop the flow of the SDK.\n          console.error(e);\n        }\n      }\n    };\n  }\n}\n\n/**\n * An implementation of {@link PopupRedirectResolver} suitable for Cordova\n * based applications.\n *\n * @public\n */\nexport const cordovaPopupRedirectResolver: PopupRedirectResolver =\n  CordovaPopupRedirectResolver;\n\nfunction generateNoEvent(): AuthEvent {\n  return {\n    type: AuthEventType.UNKNOWN,\n    eventId: null,\n    sessionId: null,\n    urlResponse: null,\n    postBody: null,\n    tenantId: null,\n    error: _createError(AuthErrorCode.NO_AUTH_EVENT)\n  };\n}\n","/**\n * @license\n * Copyright 2017 Google LLC\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this file except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n */\n\nimport { _castAuth } from '../src/core/auth/auth_impl';\nimport { Auth } from '../src/model/public_types';\n\n/**\n * This interface is intended only for use by @firebase/auth-compat, do not use directly\n */\nexport * from '../index';\n\nexport { SignInWithIdpResponse } from '../src/api/authentication/idp';\nexport { AuthErrorCode } from '../src/core/errors';\nexport { PersistenceInternal } from '../src/core/persistence';\nexport { _persistenceKeyName } from '../src/core/persistence/persistence_user_manager';\nexport { UserImpl } from '../src/core/user/user_impl';\nexport { _getInstance } from '../src/core/util/instantiator';\nexport {\n  PopupRedirectResolverInternal,\n  EventManager,\n  AuthEventType\n} from '../src/model/popup_redirect';\nexport { UserCredentialInternal, UserParameters } from '../src/model/user';\nexport { AuthInternal, ConfigInternal } from '../src/model/auth';\nexport { DefaultConfig, AuthImpl, _castAuth } from '../src/core/auth/auth_impl';\n\nexport { ClientPlatform, _getClientVersion } from '../src/core/util/version';\n\nexport { _generateEventId } from '../src/core/util/event_id';\nexport { TaggedWithTokenResponse } from '../src/model/id_token';\nexport { _fail, _assert } from '../src/core/util/assert';\nexport { AuthPopup } from '../src/platform_browser/util/popup';\nexport { _getRedirectResult } from '../src/platform_browser/strategies/redirect';\nexport { cordovaPopupRedirectResolver } from '../src/platform_cordova/popup_redirect/popup_redirect';\nexport { FetchProvider } from '../src/core/util/fetch_provider';\nexport { SAMLAuthCredential } from '../src/core/credentials/saml';\n\n// This function should only be called by frameworks (e.g. FirebaseUI-web) to log their usage.\n// It is not intended for direct use by developer apps. NO jsdoc here to intentionally leave it out\n// of autogenerated documentation pages to reduce accidental misuse.\nexport function addFrameworkForLogging(auth: Auth, framework: string): void {\n  _castAuth(auth)._logFramework(framework);\n}\n"]},"metadata":{},"sourceType":"module"}