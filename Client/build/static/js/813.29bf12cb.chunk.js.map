{"version":3,"file":"static/js/813.29bf12cb.chunk.js","mappings":"sQA8GA,UAtGyB,WAErB,IAAOA,GAAQC,EAAAA,EAAAA,KAAY,SAACC,GAAD,iBAAcA,MAAlCF,MACXG,EAAAA,EAAAA,YAAU,WACHH,GAAQA,EAAKI,OAAQC,EAAS,OACnC,CAACL,IACH,IAAIM,GAASC,EAAAA,EAAAA,MAEPC,EAAY,mCAAC,WAAOC,GAAP,iFACFC,IAAAA,KAAW,mDAAmD,GAAG,CAC1EC,QAAQ,CACJF,UAAAA,KAHO,mFAAD,sDAWlB,GAAsBG,EAAAA,EAAAA,UAAS,IAA/B,eAAMC,EAAN,KAAYC,EAAZ,KACA,GAAoBF,EAAAA,EAAAA,UAAS,IAA7B,eAAMG,EAAN,KAAWC,EAAX,MACAb,EAAAA,EAAAA,YAAU,WACVW,EAASG,OAAOC,aAAaC,QAAQ,wBACnC,IACF,IAAMd,GAAUe,EAAAA,EAAAA,MACVC,EAAW,mCAAC,WAAOC,GAAP,yFAEdA,EAAEC,iBAFY,SAGIC,EAAAA,EAAAA,oBAAyBX,EAAMI,OAAOQ,SAASC,MAHnD,kBAIL1B,KAAK2B,cAJA,wBAMXV,OAAOC,aAAaU,WAAW,qBAE3B5B,EAAKwB,EAAAA,EAAAA,YARE,UASLxB,EAAK6B,eAAed,GATf,QAULe,EAAS9B,EAAK+B,mBACpBvB,EAAasB,EAAQ1B,OAEpB4B,MAAK,SAAAC,GAAG,OAER3B,EAAS,CACL4B,KAAM,iBACNC,QAAS,CACLC,KAAKH,EAAII,KAAKD,KACdvB,MAAMoB,EAAII,KAAKxB,MACfT,MAAM0B,EAAQ1B,MACdkC,KAAKL,EAAII,KAAKC,KACdC,IAAIN,EAAII,KAAKE,UAKtBlC,EAAS,KA3BE,0DAgCVmC,QAAQC,IAAR,MAhCU,0DAAD,sDAwCb,OACI,+BACD,iBAAKC,UAAU,iBAAiBC,MAAO,CAACC,OAAO,mBAA/C,WACI,mDAEJ,gBAAKF,UAAU,MAAf,UACI,gBAAKA,UAAU,6BAAf,UAGJ,kBAAMG,SAAUxB,EAAhB,WACK,kBACAa,KAAK,QACLQ,UAAU,eACVC,MAAO,CAACG,MAAM,QAAQF,OAAO,oBAC7BG,MAAOlC,EACPmC,UAAQ,KAER,kBACAd,KAAK,WACLQ,UAAU,eACVC,MAAO,CAACG,MAAM,QAAQF,OAAO,oBAC7BG,MAAOhC,EACPkC,SAAU,SAAA3B,GAAIN,EAAQM,EAAE4B,OAAOH,QAC/BI,WAAS,KAET,mBAAQjB,KAAK,SAASa,MAAM,SAASL,UAAU,iBAAgBC,MAAO,CAACC,OAAO,oBAA9E,mC","sources":["pages/auth/CompleteRegister.js"],"sourcesContent":["import React,{useState,useEffect} from 'react'\r\nimport  {auth} from \"../../firebase\"\r\nimport {toast} from \"react-toastify\"\r\nimport { useDispatch,useSelector } from 'react-redux'\r\nimport \"react-toastify/dist/ReactToastify.css\"\r\nimport {useNavigate} from \"react-router-dom\"\r\n\r\nimport axios from \"axios\"\r\nconst CompleteRegister = () => {\r\n    \r\n    const {user} = useSelector((state)=>({...state}))\r\nuseEffect(()=>{\r\n    if(user && user.token ) navigate('/')\r\n},[user])\r\nlet dispatch=useDispatch()\r\n\r\nconst createUpdate=async (authtoken)=>{\r\n    return await axios.post(\"http://localhost:8000/api/create-and-update-user\",{},{              //axios is sending request to middleware having url as first argument   \r\n        headers:{\r\n            authtoken\r\n        }\r\n    } )\r\n}    \r\n\r\n\r\n\r\n\r\nconst[email,setemail]=useState('');\r\nconst[pass,setpass]=useState('')\r\nuseEffect(()=>{\r\nsetemail(window.localStorage.getItem(\"emailRegistration\"))\r\n},[])\r\nconst navigate =useNavigate();\r\nconst handleClick=async (e)=>{\r\n    try{\r\n    e.preventDefault();\r\n   const result=await auth.signInWithEmailLink(email,window.location.href)\r\n   if(result.user.emailVerified){\r\n       //REMOVE EMAIL FROM LOCAL STORAGE\r\n       window.localStorage.removeItem('emailRegistration')\r\n       //GET USER TOKEN ID FOR USING IN REDUX STORE FOR FUTURE USE and also update password for future verification\r\n       let user=auth.currentUser;\r\n       await user.updatePassword(pass)\r\n       const idToken =user.getIdTokenResult();\r\n       createUpdate(idToken.token)\r\n       \r\n       .then(res=>\r\n        \r\n        dispatch({\r\n            type: \"LOGGED_IN_USER\",\r\n            payload :{                                //res here deines response from backend as axios made a post request\r\n                name:res.data.name,\r\n                email:res.data.email,\r\n                token:idToken.token,\r\n                role:res.data.role,\r\n                _id:res.data._id\r\n            }\r\n        })\r\n        \r\n       )\r\n       navigate('/')\r\n     }\r\n    }\r\n\r\n    catch(error){\r\n        console.log(error)\r\n    }\r\n   \r\n}\r\n\r\n    \r\n\r\n    \r\n    return (\r\n        <>\r\n       <div className=\"container p-5 \" style={{margin:\"0px 400px 100px\"}} >\r\n           <h4 >Complete Registration</h4>\r\n\r\n       <div className='row'>\r\n           <div className='col-mid-3 offset col-mid-6'>\r\n               \r\n      \r\n       <form onSubmit={handleClick} >\r\n            <input\r\n            type='email'\r\n            className='form-control'\r\n            style={{width:\"600px\",margin:\"10px 0px 0px 0px\"}}\r\n            value={email}\r\n            disabled\r\n            ></input>\r\n            <input\r\n            type='password'\r\n            className='form-control'\r\n            style={{width:\"600px\",margin:\"10px 0px 0px 0px\"}}\r\n            value={pass}\r\n            onChange={e=>{setpass(e.target.value)}}\r\n            autoFocus\r\n            ></input>\r\n            <button type='submit' value='submit' className='btn btn-raised'style={{margin:\"20px 0px 0px 0px\"}}>Sign in</button>\r\n\r\n        </form>\r\n        </div>\r\n       </div>\r\n       \r\n       </div>\r\n\r\n        </>\r\n    )\r\n}\r\n\r\nexport default CompleteRegister;\r\n"],"names":["user","useSelector","state","useEffect","token","navigate","dispatch","useDispatch","createUpdate","authtoken","axios","headers","useState","email","setemail","pass","setpass","window","localStorage","getItem","useNavigate","handleClick","e","preventDefault","auth","location","href","emailVerified","removeItem","updatePassword","idToken","getIdTokenResult","then","res","type","payload","name","data","role","_id","console","log","className","style","margin","onSubmit","width","value","disabled","onChange","target","autoFocus"],"sourceRoot":""}